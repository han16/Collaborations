---
title: "9/14/2022"
output: html_document
date: '2022-09-14'
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(ggpubr)
library(rstatix) # use anova_test function 
library(DT)
set.seed(123)
```


```{r, echo=F, warning=F, message=F}
pvalue_adjust=function(p_value)
{
  p_value_adjust=numeric()
for (i in 1:length(p_value))
{
  if (is.na(p_value[i])==T)
    p_value_adjust[i]=p_value[i]
  if (is.na(p_value[i])==F & p_value[i]<0.0001)
    p_value_adjust[i]="<0.0001"
  if (is.na(p_value[i])==F & p_value[i]>0.0001)
    p_value_adjust[i]=round(p_value[i],4)
}
  return(p_value_adjust)
  
}  
  
summary_statistics=function(data)
{  # each column is one variable, and row one subject 
  
variables=colnames(data)
num_sample=numeric()
Mean=numeric()
SD=numeric()
SE=numeric()
range_min=numeric()
range_max=numeric()
normality_pvalue=numeric()
for (i in 1:ncol(data))
{
  observation=data[,i]
  observation=observation[!is.na(observation)] # remove missing values 
  num_sample[i]=length(observation)
  Mean[i]=round(mean(observation),4)
  SD[i]=round(sd(observation),4)
  SE[i]=round(SD[i]/sqrt(num_sample[i]),4)
  range_min[i]=round(min(observation),4)
  range_max[i]=round(max(observation),4)
  normality_pvalue[i]=round(shapiro.test(observation)$p.value,4)
}

summary_data=data.frame(materials=variables, num_sample=num_sample, Mean=Mean, SD=SD, SE=SE, Range_low=range_min, Range_upper=range_max, normality_pvalue=normality_pvalue)

summary_data%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
  
 return(summary_data) 
}


lmp <- function (modelobject) {
    if (class(modelobject) != "lm") stop("Not an object of class 'lm' ")
    f <- summary(modelobject)$fstatistic
    p <- pf(f[1],f[2],f[3],lower.tail=F)
    attributes(p) <- NULL
    return(p)
}
```





```{r, echo=F, message=F, warning=F}

data=as_tibble(read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\Research Valencia-Kofina implants final n=26.csv"))
data$Width_3mm_T5=abs(data$Width_3mm_T5) # all observations for "Width_3mm" must be positive 
data$Width_3mm_T6=abs(data$Width_3mm_T6)
old_data=as_tibble(read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\Research Valencia-Kofina implants.csv"))
old_data2=as_tibble(read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\Research Valencia-Kofina implants.csv"))
wound_open_new=read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\JV implants n=26.csv", header=T)
###### update wound_open 
data$Wound_open_T3_YN=wound_open_new$Wound_open_T3_YN
data$Wound_open_T4_YN=wound_open_new$Wound_open_T4_YN
data$Wound_open_T5_YN=wound_open_new$Wound_open_T5_YN
data$Wound_open_T6_YN=wound_open_new$Wound_open_T6_YN
#colnames(data)
```




## Distribution of variables 

### Age 

```{r, echo=F, message=F, warning=F}
p=ggplot(data.frame(var=rep("Age", 26), Age=data$Age), aes(x=var, y=Age))+
  geom_boxplot()
p+geom_dotplot(binaxis='y', stackdir='center', dotsize=0.6)+
  ggtitle("boxplot of Age")+
  theme(plot.title = element_text(hjust = 0.5, size=15)) # center the title


#round(mean(data$Age),2) # mean 
#round(sd(data$Age),2)  # sd 
#round(sd(data$Age)/sqrt(nrow(data)),2) # se
#min(data$Age) # minimum 
#max(data$Age) # maximum 
#median(data$Age) # maximum 
summary(data$Age)
```




| Mean      | SD |   SE    | Range          | median
| :---        |    :----:   |   :----:   |        ---: |  ---: |
| 54.15    | 16.55   | 3.25   | (27, 73) | 58.5 |



### Gender 

```{r, echo=F, message=F, warning=F}
g1=ggplot(data %>% count(Gender) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Gender), y=prop, fill=as.factor(Gender))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Gender (%)")+ylim(c(0,1))+
  xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Gender), aes(x=as.factor(Gender), y=n, fill=as.factor(Gender))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Gender")+
  xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

#gender_count=data %>% count(Gender) %>% select(n) %>% pull
#binom.test(gender_count[1], sum(gender_count), p = 0.5)
```

* large p value of 0.845 suggests no difference between gender. 


### Race 


```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Race) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Race), y=prop, fill=as.factor(Race))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Race (%)")+ylim(c(0,1))+
  xlab("Race: 1=white, 2=Hispanic, 5=African American")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Race), aes(x=as.factor(Race), y=n, fill=as.factor(Race))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Race")+
  xlab("Race: 1=white, 2=Hispanic, 5=African American")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* sample size is not large enough to test the difference 


### Site 


```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Site) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Site), y=prop, fill=as.factor(Site))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Site")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Site), aes(x=as.factor(Site), y=n, fill=as.factor(Site))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Site")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* many sites have too few counts (<10) to test the difference 

###  Type_bone_graft 



```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Type_bone_graft) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Type_bone_graft), y=prop, fill=as.factor(Type_bone_graft))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Type_bone_graft")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Type_bone_graft), aes(x=as.factor(Type_bone_graft), y=n, fill=as.factor(Type_bone_graft))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Type_bone_graft")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* numbers are too small (<10) to test the difference



###  Exp_level



```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Exp_level) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Exp_level), y=prop, fill=as.factor(Exp_level))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Exp_level")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Exp_level), aes(x=as.factor(Exp_level), y=n, fill=as.factor(Exp_level))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Exp_level")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```


* numbers are too small (<10) to test the difference



## summary statistics 


```{r, echo=F, message=F, warning=F}
sub_data=data.frame(Age=data$Age, Time_bone_graft=data$Time_bone_graft..months., Ging_thick=data$Ging_thick, Muc_thick=data$Muc_thick, Duration_min=data$Duration.min., Suture_removal=data$Suture_removal, Ging_width_T1=data$Ging_width_T1, Ging_width_T6=data$Ging_width_T6)
Mean=numeric()
SD=numeric()
SE=numeric()
range_min=numeric()
range_max=numeric()
median=numeric()
Q1=numeric()
Q3=numeric()
normality_pvalue=numeric()
for (i in 1:ncol(sub_data))
{
  Mean[i]=round(mean(sub_data[,i],na.rm=T),4)
  SD[i]=round(sd(sub_data[,i], na.rm=T),4)
  SE[i]=round(SD[i]/sqrt(nrow(sub_data)),4)
  range_min[i]=round(min(sub_data[,i], na.rm=T),4)
  range_max[i]=round(max(sub_data[,i], na.rm=T),4)
  median[i]=summary(sub_data[,i], na.rm=T)[3]
  Q1[i]=summary(sub_data[,i], na.rm=T)[2]
  Q3[i]=summary(sub_data[,i], na.rm=T)[5]
  normality_pvalue[i]=round(shapiro.test(sub_data[,i])$p.value,4)
  
}

data.frame(Time=c("Age", "Time_bone_graft", "Ging_thick", "Muc_thick", "Duration(min)", "Suture_removal", "Ging_width_T1", "Ging_width_T6"), Mean=Mean, Median=median, Q1=Q1, Q3=Q3, IQR=Q3-Q1, SD=SD, SE=SE, Range_low=range_min, Range_upper=range_max, normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

 t.test(data$Ging_width_T1, data$Ging_width_T6, paired=T) # use paired t test to test the difference 
 wilcox.test(data$Ging_width_T1, data$Ging_width_T6, paired=T)
```

* p value of 0.7824 by parametric two sample paired t test suggests no difference between `Ging_width_T1` and `Ging_width_T6`
* p value of 0.6278 by non-parametric Wilcoxon test suggests no difference between `Ging_width_T1` and `Ging_width_T6`
* IQR is Q3-Q1. 


## Width_3mm


### trajectory plot

```{r, echo=F, message=F, warning=F}
data_long=data.frame(Width_3mm=c(data$Width_3mm_T1, data$Width_3mm_T2, data$width_3mm_T3, data$Width_3mm_T4, data$Width_3mm_T5, data$Width_3mm_T6), time=rep(c("T1", "T2", "T3", "T4", "T5", "T6"), each=nrow(data)), individual=rep(data$Subject,6))

g1=ggplot(data=data_long,aes(x=time, y=Width_3mm, group=individual))+
  geom_line(color="red")+
  geom_point() # look at total PBI 


g2=ggplot(data.frame(Width_3mm_mean=c(mean(data$Width_3mm_T1),mean(data$Width_3mm_T2), mean(data$width_3mm_T3), mean(data$Width_3mm_T4), mean(data$Width_3mm_T5), mean(data$Width_3mm_T6)), time=c("T1", "T2", "T3", "T4", "T5", "T6")), aes(x=time, y=Width_3mm_mean, group=1))+
  ylim(c(min(data_long$Width_3mm), max(data_long$Width_3mm)))+
  geom_line(color="red")+
  geom_point()

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure 

# data_long %>% filter(time=="T1") %>% summarise(mean=round(mean(Width_3mm),4), SD=round(sd(Width_3mm),4), se=round(SD/23,4), min=round(min(Width_3mm),4), max=round(max(Width_3mm), 4)) 
```


```{r, echo=F, message=F, warning=F}
Width_3mm_data=matrix(nrow=nrow(data), ncol=6)
Width_3mm_data[,1]=data_long %>% filter(time=="T1") %>% select(Width_3mm) %>% pull
Width_3mm_data[,2]=data_long %>% filter(time=="T2") %>% select(Width_3mm) %>% pull
Width_3mm_data[,3]=data_long %>% filter(time=="T3") %>% select(Width_3mm) %>% pull
Width_3mm_data[,4]=data_long %>% filter(time=="T4") %>% select(Width_3mm) %>% pull
Width_3mm_data[,5]=data_long %>% filter(time=="T5") %>% select(Width_3mm) %>% pull
Width_3mm_data[,6]=data_long %>% filter(time=="T6") %>% select(Width_3mm) %>% pull
Mean=numeric(); SD=numeric(); SE=numeric(); Range_low=numeric(); Range_upper=numeric()
Median=numeric(); Q1=Q3=numeric()
normality_pvalue=numeric()
for (i in 1:6)
{
  Mean[i]=round(mean(Width_3mm_data[,i]),4)
  
  Median[i]=round(summary(Width_3mm_data[,i])[3],4)
  Q1[i]=round(summary(Width_3mm_data[,i])[2],4)
  Q3[i]=round(summary(Width_3mm_data[,i])[5],4)
  
  SD[i]=round(sd(Width_3mm_data[,i]),4)
  SE[i]=round(SD[i]/sqrt(nrow(data)),4)
  Range_low[i]=round(min(Width_3mm_data[,i]),4)
  Range_upper[i]=round(max(Width_3mm_data[,i]),4)
  normality_pvalue[i]=round(shapiro.test(Width_3mm_data[,i])$p.value,4)
}

data.frame(Time=c("T1", "T2", "T3", "T4", "T5", "T6"), Mean=Mean, Median=Median, Q1=Q1, Q3=Q3, IQR=Q3-Q1, SD=SD, SE=SE, Range_low=Range_low, Range_upper=Range_upper, normality_pvalue= normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* use `shapiro.test` to test normality assumption and p values less than 0.05 indicates evidence against normal distribution. 


### pairwise comparisons




```{r, echo=F, message=F, warning=F}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:6)
 for (j in 1:6)
{
  ii=ii+1
  samplei=data[,(5+i)] %>% pull
  samplej=data[,(5+j)] %>% pull
  test=t.test(samplei, samplej, paired=T)
  estimate[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
  #############
  wilcox_test=wilcox.test(samplei, samplej, alternative = "two.sided")
  wilcox_test_pvalue[ii]=wilcox_test$p.value
 }


result=data_frame(group1=rep(colnames(data)[6:11], each=6), group2=rep(colnames(data)[6:11],6), mean_difference=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value),wilcox_test_pvalue=pvalue_adjust(wilcox_test_pvalue)) 
result$group1[c(2:6, 8:12, 14:18, 20:24, 26:30, 32:36)]="---"

result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* use paired two sample t test and wilcox test 



### test different across all time points 

```{r, echo=F, message=F, warning=F}

res.aov <- anova_test(data = data_long, dv =Width_3mm , wid = individual, within = time)
get_anova_table(res.aov)

data_long %>% friedman_test(Width_3mm ~ time |individual)
```


* use repeated anova test 

* `Friedman test` is an non-parametric alternative test to anova for repeated measures 

* small p value indicates significant change over time 


## _T2-T1, T3-T2, T4-T2,  T5-T2 and T6-T2

### Width_diff_3mm



```{r, echo=F, message=F, warning=F}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric(); 
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
Median=Q1=Q3=numeric()
# replace data[8,13]=5.4646 by referring to old sample 
normality_pvalue=numeric()
wilcox_test_pvalue=numeric()
for (i in 1:5)
{
  current=data[,(11+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(Width_3mm_data[,i])$p.value)
  wilcox_test_pvalue[i]=wilcox.test(current, mu=0, alternative="two.sided")$p.value
}
data_frame(parameter=colnames(data)[12:16], mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue, wilcox_test_pvalue=pvalue_adjust(wilcox_test_pvalue))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* use one sample t test to test each parameter is equal to 0 or not

* one sample non-parametric test `wilcox_test_pvalue` was used 





```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(11+i)] %>% pull
  group2=data[,(11+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
  #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(data)[12:16],each=5), group2=rep(colnames(data)[12:16],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 
result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```


#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=c("Width_diff_3mm_T2.T1", "Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2","Width_diff_3mm_T5.T2","width_diff_3mm_T6.T2")

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric(); Type_bone_graft_coeffcient=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()
site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()

for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value


lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split1, data=sub_data)  
site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value
}

data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue),Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue), site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova 

* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 






#### test When variables reach T2 level 


```{r, echo=F, message=F, warning=F}


```






### Buccal_3mm

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(16+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
}
data_frame(parameter=colnames(data)[17:21], mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(16+i)] %>% pull
  group2=data[,(16+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
  #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(data)[17:21],each=5), group2=rep(colnames(data)[17:21],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```






#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=c("Buccal_3mm_T2.T1","Buccal_3mm_T2.T3","Buccal_3mm_T2.T4","Buccal_3mm_T2.T5","Buccal_3mm_T2.T6")

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()
site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()

for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value

lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value


lm_reg=lm(swelling_parameter~site_split1, data=sub_data)  
site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value

}


data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue),Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue), site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova 
* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 



### Lingual_3mm


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(21+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
}
data_frame(parameter=colnames(data)[22:26], mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(21+i)] %>% pull
  group2=data[,(21+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
   #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[22:26],each=5), group2=rep(colnames(data)[22:26],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```



#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=colnames(data)[22:26]

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()

site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()

for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value

lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value


lm_reg=lm(swelling_parameter~site_split1, data=sub_data)  
site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value


}


data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue),Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue), 
site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova 
* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 


###  Vertical_mid


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(26+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
}
data_frame(parameter=colnames(data)[27:31], mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```




```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(26+i)] %>% pull
  group2=data[,(26+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
  #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[27:31],each=5), group2=rep(colnames(data)[27:31],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=colnames(data)[27:32]

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()

site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()


for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value

lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value


lm_reg=lm(swelling_parameter~site_split1, data=sub_data)  
site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value


}


data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue),Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue), site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova 
* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 


###  Vertical_max


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
wilcox_test_pvalue=numeric()
for (i in 1:5)
{
  current=data[,(31+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  
  wilcox_test_pvalue[i]=wilcox.test(current, mu=0, alternative="two.sided")$p.value
}
data_frame(parameter=colnames(data)[32:36], mean=round(estimate,2),  Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue, wilcox_test_pvalue=pvalue_adjust(wilcox_test_pvalue))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

 
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(31+i)] %>% pull
  group2=data[,(31+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
   #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(data)[32:36],each=5), group2=rep(colnames(data)[32:36],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```

#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=colnames(data)[32:36]

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()

site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()

for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value

lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value
lm_reg=lm(swelling_parameter~site_split1, data=sub_data)  

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value

site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value

}


data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue), Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue), site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova 
* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 



## %vol 


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3
wilcox_test_pvalue=numeric()
for (i in 1:5)
{
  current=data[,(44+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  wilcox_test_pvalue[i]=wilcox.test(current, mu=0, alternative="two.sided")$p.value
}
data_frame(parameter=colnames(data)[45:49], mean=round(estimate,2),  Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue, wilcox_test_pvalue=pvalue_adjust(wilcox_test_pvalue))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```
* one sample non-parametric `wilcox.test` was used 


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(44+i)] %>% pull
  group2=data[,(44+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
   #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(data)[45:49],each=5), group2=rep(colnames(data)[45:49],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```


#### covariate effect 

```{r, echo=F, message=F, warning=F}
variables=colnames(data)[45:49]

Type_bone_graft=data%>% select("Type_bone_graft") %>% pull()
Time_bone_graft_month=data%>% select("Time_bone_graft..months.") %>% pull()

site_split1=data$Site
site_split1[data$Site<=16]="Maxilla"
site_split1[data$Site>16]="mandible"

site_split2=data$Site
site_split2[data$Site<=11 & data$Site>=6]="Anterior"
site_split2[data$Site<=27 & data$Site>=22]="Anterior"
site_split2[data$Site<=5 & data$Site>=1]="posterior"
site_split2[data$Site<=21 & data$Site>=12]="posterior"
site_split2[data$Site<=32 & data$Site>=28]="posterior"

site_split3=data$Site
site_split3[data$Site<=5 & data$Site>=1]="Sextants1"
site_split3[data$Site<=11 & data$Site>=6]="Sextants2"
site_split3[data$Site<=16 & data$Site>=12]="Sextants3"
site_split3[data$Site<=21 & data$Site>=17]="Sextants4"
site_split3[data$Site<=27 & data$Site>=22]="Sextants5"
site_split3[data$Site<=32 & data$Site>=28]="Sextants6"

Type_bone_graft_pvalue=numeric()
Type_bone_graft_kruskal_pvalue=numeric()
Time_bone_graft_month_pvalue=numeric()
Time_bone_graft_month_Spearman_cor=numeric()
site_split1_pvalue=numeric()
site_split2_pvalue=numeric()
site_split3_pvalue=numeric()

site_split1_kruskal_pvalue=numeric()
site_split2_kruskal_pvalue=numeric()
site_split3_kruskal_pvalue=numeric()

for (i in 1:length(variables))
  
{
sub_data=data.frame(swelling_parameter=data %>% select(variables[i]) %>% pull, Type_bone_graft, Time_bone_graft_month, site_split1, site_split2, site_split3)

lm_reg=lm(swelling_parameter~Time_bone_graft_month, data=sub_data)  
Time_bone_graft_month_pvalue[i]=lmp(lm_reg) # get regression model p value

sub_data2=data.frame(swelling_parameter=sub_data$swelling_parameter, Time_bone_graft_month=sub_data$Time_bone_graft_month) %>% drop_na()
Time_bone_graft_month_Spearman_cor[i]=cor(sub_data2$swelling_parameter,sub_data2$Time_bone_graft_month, method="spearman" )

lm_reg=lm(swelling_parameter~as.character(Type_bone_graft), data=sub_data)  
Type_bone_graft_pvalue[i]=lmp(lm_reg) # get regression model p value

Type_bone_graft_kruskal_pvalue[i]=kruskal.test(swelling_parameter~as.character(Type_bone_graft), data=sub_data)$p.value

site_split1_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split1_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split1, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split2, data=sub_data)  
site_split2_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split2_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split2, data=sub_data)$p.value

lm_reg=lm(swelling_parameter~site_split3, data=sub_data)  
site_split3_pvalue[i]=lmp(lm_reg) # get regression model p value

site_split3_kruskal_pvalue[i]=kruskal.test(swelling_parameter~site_split3, data=sub_data)$p.value


}


data.frame(variables, Type_bone_graft_pvalue=pvalue_adjust(Type_bone_graft_pvalue),Type_bone_graft_kruskal_pvalue=pvalue_adjust(Type_bone_graft_kruskal_pvalue), Time_bone_graft_month_pvalue=pvalue_adjust(Time_bone_graft_month_pvalue),
Time_bone_graft_month_Spearman_cor=round(Time_bone_graft_month_Spearman_cor, 2), 
site_split1_pvalue=pvalue_adjust(site_split1_pvalue), site_split1_kruskal_pvalue=pvalue_adjust(site_split1_kruskal_pvalue), site_split2_pvalue=pvalue_adjust(site_split2_pvalue), 
site_split2_kruskal_pvalue=pvalue_adjust(site_split2_kruskal_pvalue), site_split3_pvalue=pvalue_adjust(site_split3_pvalue), 
site_split3_kruskal_pvalue=pvalue_adjust(site_split3_kruskal_pvalue))%>%
datatable(extensions = 'Buttons',
          caption="",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* anova test was used for categorical variables and linear regression for continuous variables 
* non-parametric Kruskal–Wallis test for anova
* site_split1: Maxilla: 1-16 vs. mandible 17-32
* site_split2: Anterior: 6-11 and 22-27 vs. posterior: 1-5, 12-21, 28-32
* site_split3: Sextants: 1-5 vs. 6-11 vs. 12-16 vs. 17-21 vs. 22-27 vs. 28-32
* p value less than 0.05 indicates significant effect 
* p value is testing the overall significance of covariates in the model  


## VAS_pain 

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(49+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}
##############
for (j in 1:4)
{
  i=5+j
  current=data[,(50+j)] %>% pull-data[,50] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}

data_frame(parameter=c(colnames(data)[50:54],paste(colnames(data[,51:54]), colnames(data[50]), sep="-") ), mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(49+i)] %>% pull
  group2=data[,(49+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
   #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[50:54],each=5), group2=rep(colnames(data)[50:54],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



## VAS_swell

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(54+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
   if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}
##############
for (j in 1:4)
{
  i=5+j
  current=data[,(55+j)] %>% pull-data[,55] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}


data_frame(parameter=c(colnames(data)[55:59],paste(colnames(data[,56:59]), colnames(data[55]), sep="-") ), mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(54+i)] %>% pull
  group2=data[,(54+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
    #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(data)[55:59],each=5), group2=rep(colnames(data)[55:59],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```

## VAS_mouth_open 



```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(59+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
  
}
##############
for (j in 1:4)
{
  i=5+j
  current=data[,(60+j)] %>% pull-data[,60] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}

data_frame(parameter=c(colnames(data)[60:64],paste(colnames(data[,61:64]), colnames(data[60]), sep="-")), mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(59+i)] %>% pull
  group2=data[,(59+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
    #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[60:64],each=5), group2=rep(colnames(data)[60:64],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```


## OHIP 


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:5)
{
  current=data[,(64+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}

##############
for (j in 1:4)
{
  i=5+j
  current=data[,(65+j)] %>% pull-data[,65] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
}

data_frame(parameter=c(colnames(data)[65:69],paste(colnames(data[,66:69]), colnames(data[65]), sep="-")), mean=round(estimate,2), Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

 
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(64+i)] %>% pull
  group2=data[,(64+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
     #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[65:69],each=5), group2=rep(colnames(data)[65:69],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

## Wound_open_bl 




```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
normality_pvalue=numeric()
Median=Q1=Q3=numeric()
for (i in 1:4)
{
  current=data[,(69+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD[i]/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
  
  Median[i]=round(summary(current)[3],4)
  Q1[i]=round(summary(current)[2],4)
  Q3[i]=round(summary(current)[5],4)
  
  
   if (length(unique(current))>1)
   normality_pvalue[i]=pvalue_adjust(shapiro.test(current)$p.value)
  if (length(unique(current))==1)
   normality_pvalue[i]=NA
  
}
data_frame(parameter=colnames(data)[70:73], mean=round(estimate,2),  Median, Q1, Q3, IQR=Q3-Q1, CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4), normality_pvalue=normality_pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  group1=data[,(69+i)] %>% pull
  group2=data[,(69+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
       #############
  wilcox_test=wilcox.test(group1, group2, paired=T, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(data)[70:73],each=4), group2=rep(colnames(data)[70:73],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```

## Wound_open 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Wound_open_T3_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T3_YN, y=prop, fill=Wound_open_T3_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Wound_open_T3_YN), aes(x=Wound_open_T3_YN, y=n, fill=Wound_open_T3_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

################################

g21=ggplot(data %>% count(Wound_open_T4_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T4_YN, y=prop, fill=Wound_open_T4_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Wound_open_T4_YN), aes(x=Wound_open_T4_YN, y=n, fill=Wound_open_T4_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###################################

g31=ggplot(data %>% count(Wound_open_T5_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T5_YN, y=prop, fill=Wound_open_T5_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Wound_open_T5_YN), aes(x=Wound_open_T5_YN, y=n, fill=Wound_open_T5_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################
g41=ggplot(data %>% count(Wound_open_T6_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T6_YN, y=prop, fill=Wound_open_T6_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Wound_open_T6_YN), aes(x=Wound_open_T6_YN, y=n, fill=Wound_open_T6_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```






```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(73+i)]=="Y") # No of yes 
  n2=sum(data[,(73+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[74:77],each=4), group2=rep(colnames(data)[74:77],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* `mean_difference` means the proportion of `Y` between group1 and group 2  


## Bleeding


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Bleeding_T3) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T3, y=prop, fill=Bleeding_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Bleeding_T3), aes(x=Bleeding_T3, y=n, fill=Bleeding_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###############################
g21=ggplot(data %>% count(Bleeding_T4) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T4, y=prop, fill=Bleeding_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Bleeding_T4), aes(x=Bleeding_T4, y=n, fill=Bleeding_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
##################################
g31=ggplot(data %>% count(Bleeding_T5) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T5, y=prop, fill=Bleeding_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Bleeding_T5), aes(x=Bleeding_T5, y=n, fill=Bleeding_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###############################
g41=ggplot(data %>% count(Bleeding_T6) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T6, y=prop, fill=Bleeding_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Bleeding_T6), aes(x=Bleeding_T6, y=n, fill=Bleeding_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```




```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(77+i)]=="Y") # No of yes 
  n2=sum(data[,(77+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[78:81],each=4), group2=rep(colnames(data)[78:81],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2  





## Bruising

```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Bruising_T2) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T2, y=prop, fill=Bruising_T2)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Bruising_T2), aes(x=Bruising_T2, y=n, fill=Bruising_T2)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
############################

g21=ggplot(data %>% count(Bruising_T3) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T3, y=prop, fill=Bruising_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Bruising_T3), aes(x=Bruising_T3, y=n, fill=Bruising_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
######################
g31=ggplot(data %>% count(Bruising_T4) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T4, y=prop, fill=Bruising_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Bruising_T4), aes(x=Bruising_T4, y=n, fill=Bruising_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
#############################
g41=ggplot(data %>% count(Bruising_T5) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T5, y=prop, fill=Bruising_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Bruising_T5), aes(x=Bruising_T5, y=n, fill=Bruising_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

########################
g51=ggplot(data %>% count(Bruising_T6) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T6, y=prop, fill=Bruising_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g52=ggplot(data %>% count(Bruising_T6), aes(x=Bruising_T6, y=n, fill=Bruising_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,g41,g51,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,g52,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  n1=sum(data[,(81+i)]=="Y") # No of yes 
  n2=sum(data[,(81+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[82:86],each=5), group2=rep(colnames(data)[82:86],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2 




## Flap_necrosis 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Flap_necrosis_T3) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T3, y=prop, fill=Flap_necrosis_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Flap_necrosis_T3), aes(x=Flap_necrosis_T3, y=n, fill=Flap_necrosis_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
########################
g21=ggplot(data %>% count(Flap_necrosis_T4) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T4, y=prop, fill=Flap_necrosis_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Flap_necrosis_T4), aes(x=Flap_necrosis_T4, y=n, fill=Flap_necrosis_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#######################
g31=ggplot(data %>% count(Flap_necrosis_T5) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T5, y=prop, fill=Flap_necrosis_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Flap_necrosis_T5), aes(x=Flap_necrosis_T5, y=n, fill=Flap_necrosis_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

######################
g41=ggplot(data %>% count(Flap_necrosis_T6) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T6, y=prop, fill=Flap_necrosis_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Flap_necrosis_T6), aes(x=Flap_necrosis_T6, y=n, fill=Flap_necrosis_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 


##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)
```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(86+i)]=="Y") # No of yes 
  n2=sum(data[,(86+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[87:90],each=4), group2=rep(colnames(data)[87:90],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2  





## Loose_sutures 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Loose_Sutures_T3) %>%mutate(prop=n/nrow(data)), aes(x=Loose_Sutures_T3, y=prop, fill=Loose_Sutures_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Loose_Sutures_T3), aes(x=Loose_Sutures_T3, y=n, fill=Loose_Sutures_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#############################

g21=ggplot(data %>% count(Loose_sutures_T4) %>%mutate(prop=n/nrow(data)), aes(x=Loose_sutures_T4, y=prop, fill=Loose_sutures_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Loose_sutures_T4), aes(x=Loose_sutures_T4, y=n, fill=Loose_sutures_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+ylim(c(0,28))+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#####################
g31=ggplot(data %>% count(Loose_sutures_T5) %>%mutate(prop=n/nrow(data)), aes(x=Loose_sutures_T5, y=prop, fill=Loose_sutures_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Loose_sutures_T5), aes(x=Loose_sutures_T5, y=n, fill=Loose_sutures_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,
                   # labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,
                   # labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```




```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:3)
  for (j in 1:3)
{
  ii=ii+1
  n1=sum(data[,(90+i)]=="Y") # No of yes 
  n2=sum(data[,(90+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[91:93],each=3), group2=rep(colnames(data)[91:93],3), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:3, 5:6, 8:9)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```


## T2-T1 


```{r, echo=F, message=F, warning=F}
T2.T1=data %>% select(ends_with("T2.T1"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T2.T1[,i] %>% pull
  group2=T2.T1[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
       #############
  wilcox_test=wilcox.test(group1, group2, paired=F, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(T2.T1),each=5), group2=rep(colnames(T2.T1),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```


## T3-T2 

```{r, echo=F, message=F, warning=F}
T3.T2=data %>% select(ends_with("T3.T2") | ends_with("T2.T3"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T3.T2[,i] %>% pull
  group2=T3.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
       #############
  wilcox_test=wilcox.test(group1, group2, paired=F, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(T3.T2),each=5), group2=rep(colnames(T3.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



## T4-T2 

```{r, echo=F, message=F, warning=F}
T4.T2=data %>% select(ends_with("T4.T2") | ends_with("T2.T4"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T4.T2[,i] %>% pull
  group2=T4.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
       #############
  wilcox_test=wilcox.test(group1, group2, paired=F, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(T4.T2),each=5), group2=rep(colnames(T4.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```


## T5-T2 

```{r, echo=F, message=F, warning=F}
T5.T2=data %>% select(ends_with("T5.T2") | ends_with("T2.T5"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T5.T2[,i] %>% pull
  group2=T5.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
       #############
  wilcox_test=wilcox.test(group1, group2, paired=F, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
}
result=data_frame(group1=rep(colnames(T5.T2),each=5), group2=rep(colnames(T5.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```


## T6-T2 

```{r, echo=F, message=F, warning=F}
T6.T2=data %>% select(ends_with("T6.T2") | ends_with("T2.T6"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
wilcox_test_pvalue=numeric()
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T6.T2[,i] %>% pull
  group2=T6.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
       #############
  wilcox_test=wilcox.test(group1, group2, paired=F, alternative = "two.sided")
  wilcox_test_pvalue[ii]=pvalue_adjust(wilcox_test$p.value)
  
}
result=data_frame(group1=rep(colnames(T6.T2),each=5), group2=rep(colnames(T6.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), wilcox_test_pvalue=wilcox_test_pvalue) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

## correlation matrix 

### parametric pearson correlation 

#### correlation matrix 1 


```{r, echo=F, message=F, warning=F}
library(reshape2)
sub_data=data.frame(Ging_width_T1=data$Ging_width_T1, Ging_width_T6=data$Ging_width_T6, Ging_thick=data$Ging_thick, Muc_thick=data$Muc_thick,Wound_open_bl_T3=data$Wound_open_bl_T3, Wound_open_bl_T4=data$Wound_open_bl_T4, Wound_open_bl_T5=data$Wound_open_bl_T5, Wound_open_bl_T6=data$Wound_open_bl_T6,Width_3mm_T1=data$Width_3mm_T1
,Width_3mm_T2=data$Width_3mm_T2, Width_3mm_T3=data$width_3mm_T3, Width_3mm_T4=data$Width_3mm_T4,
Width_3mm_T5=data$Width_3mm_T5, Width_3mm_T6=data$Width_3mm_T6, Width_diff_3mm_T2_T1=data$Width_diff_3mm_T2.T1, Width_diff_3mm_T3_T2=data$Width_diff_3mm_T3.T2, Width_diff_3mm_T4_T2=data$Width_diff_3mm_T4.T2, Width_diff_3mm_T5_T2=data$Width_diff_3mm_T5.T2, Width_diff_3mm_T6_T2=data$width_diff_3mm_T6.T2, Buccal_3mm_T2_T1=data$Buccal_3mm_T2.T1, Buccal_3mm_T2_T3=data$Buccal_3mm_T2.T3, Buccal_3mm_T2_T4=data$Buccal_3mm_T2.T4, Buccal_3mm_T2_T5=data$Buccal_3mm_T2.T5, Buccal_3mm_T2_T6=data$Buccal_3mm_T2.T6, Lingual_3mm_T2_T1=data$Lingual_3mm_T2.T1, Lingual_3mm_T2_T3=data$Lingual_3mm_T2.T3, Lingual_3mm_T2_T4=data$Lingual_3mm_T2.T4, Lingual_3mm_T2_T5=data$Lingual_3mm_T2.T5, Lingual_3mm_T2_T6=data$Lingual_3mm_T2.T6, Vertical_mid_T2_T1=data$Vertical_mid_T2.T1, Vertical_mid_T2_T3=data$Vertical_mid_T2.T3, Vertical_mid_T2_T4=data$Vertical_mid_T2.T4, Vertical_mid_T2_T5=data$Vertical_mid_T2.T5, Vertical_mid_T2_T6=data$Vertical_mid_T2.T6, Vertical_max_T2_T1=data$Vertical_max_T2.T1, Vertical_max_T2_T3=data$Vertical_max_T2.T3, Vertical_max_T2_T4=data$Vertical_max_T2.T4, Vertical_max_T2_T5=data$Vertical_max_T2.T5, Vertical_max_T2_T6=data$Vertical_max_T2.T6, X.Vol_T2.T1.T1=data$X.Vol_T2.T1.T1, X.Vol_T3.T2.T2=data$X.Vol_T3.T2.T2, X.Vol_T4.T2.T2=data$X.Vol_T4.T2.T2,  X.Vol_T5.T2.T2=data$X.Vol_T5.T2.T2,  X.Vol_T6.T2.T2=data$X.Vol_T6.T2.T2, VAS_pain_T1=data$VAS_pain_T1, VAS_pain_T3=data$VAS_pain_T3, VAS_pain_T4=data$VAS_pain_T4, VAS_pain_T5=data$VAS_pain_T5, VAS_pain_T6=data$VAS_pain_T6, VAS_swell_T1=data$VAS_swell_T1,VAS_swell_T3=data$VAS_swell_T3, VAS_swell_T4=data$VAS_swell_T4, VAS_swell_T5=data$VAS_swell_T5, VAS_swell_T6=data$VAS_swell_T6, VAS_mouth_open_T1=data$VAS_mouth_open_T1, VAS_mouth_open_T3=data$VAS_mouth_open_T3, VAS_mouth_open_T4=data$VAS_mouth_open_T4, VAS_mouth_open_T5=data$VAS_mouth_open_T5, VAS_mouth_open_T6=data$VAS_mouth_open_T6, OHIP_T1=data$OHIP_T1, OHIP_T3=data$OHIP_T3, OHIP_T4=data$OHIP_T4, OHIP_T5=data$OHIP.T5, OHIP_T6=data$OHIP_T6)
################ compute p values 
cormat2=round(cor(sub_data, method="pearson"),2)
cormat2_pvalue=matrix(nrow=nrow(cormat2), ncol=nrow(cormat2))
for (i in 1:nrow(cormat2))
  for (j in 1:ncol(cormat2))
    cormat2_pvalue[i,j]=round(cor.test(sub_data[,i], sub_data[,j], method="pearson")$p.value,4)
row.names(cormat2_pvalue)=rownames(cormat2) 
colnames(cormat2_pvalue)=rownames(cormat2) 
################
cormat_with_lables <- round(cor(sub_data),2)
sub_data_col_names=colnames(sub_data)
colnames(sub_data)=seq(1:length(sub_data_col_names))
  cormat <- round(cor(sub_data),2)
  
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
  upper_tri <- get_upper_tri(cormat)
  
melted_cormat <- melt(cormat)
melted_cormat_with_labels=melt(cormat_with_lables)

# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
var_index=seq(1,length(sub_data_col_names), by=3)
var_index2=1:length(sub_data_col_names)
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
  #theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1))+
  scale_x_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
  scale_y_continuous("var_index", labels = as.character(var_index), breaks = var_index)#+
 #coord_fixed()

correlation_pvalue=matrix(paste(cormat2, cormat2_pvalue, sep="_"), nrow=nrow(cormat2))
rownames(correlation_pvalue)=row.names(cormat2)
colnames(correlation_pvalue)=row.names(cormat2)
############################
#ggplot(data = melted_cormat_with_labels, aes(Var2, Var1, fill = value))+
# geom_tile(color = "white")+
# scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
#   midpoint = 0, limit = c(-1,1), space = "Lab", 
#   name="Pearson\nCorrelation") +
#  theme_minimal()+ 
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, 
#    size = 10, hjust = 0.5))+
# coord_fixed()


#write.csv(cormat2, file="../../2022/202209/Juan/Juan_correlation_matrix_1208_2022.csv")
#write.csv(cormat2_pvalue, file="../../2022/202209/Juan/Juan_correlation_matrix_pvalue_1209_2022.csv")
#write.csv(correlation_pvalue, file="../../2022/202209/Juan/Juan_correlation_matrix_pvalue_0222_2023.csv")
#cormat2%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))

#data.frame(var_index=var_index2, variables=sub_data_col_names)%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))
```



```{r, echo=F, message=F, warning=F, eval=F}
library(heatmaply)

heatmaply_cor(
  cor(sub_data),
  xlab = "Features", 
  ylab = "Features",
  na.rm=T
)


df <- mtcars
heatmaply_cor(
  cor(df),
  xlab = "Features", 
  ylab = "Features"
)
```



* [pearson correlation matrix and p values](https://marq-my.sharepoint.com/:x:/g/personal/shengtong_han_marquette_edu/EUHKs-fEVP5Nvq3zf7oc5ksBfpLMhRZnOExoQ5SwYrtq8g?e=WF8Vep), i.e. `correlation_pvalue`. 

* `NA` in the correlation matrix means one of variables is constant, no variations leading to meaningless correlation. 

* `var_index` corresponds to row/column index in the correlation matrix 

#### Correlation matrix 2 


```{r, echo=F, message=F, warning=F}
library(reshape2)
sub_data=data.frame(Width_diff_3mm_T2_T1=data$Width_diff_3mm_T2.T1, Width_diff_3mm_T3_T2=data$Width_diff_3mm_T3.T2, Width_diff_3mm_T4_T2=data$Width_diff_3mm_T4.T2, Width_diff_3mm_T5_T2=data$Width_diff_3mm_T5.T2, Width_diff_3mm_T6_T2=data$width_diff_3mm_T6.T2, Buccal_3mm_T2_T1=data$Buccal_3mm_T2.T1, Buccal_3mm_T2_T3=data$Buccal_3mm_T2.T3, Buccal_3mm_T2_T4=data$Buccal_3mm_T2.T4, Buccal_3mm_T2_T5=data$Buccal_3mm_T2.T5, Buccal_3mm_T2_T6=data$Buccal_3mm_T2.T6, Lingual_3mm_T2_T1=data$Lingual_3mm_T2.T1, Lingual_3mm_T2_T3=data$Lingual_3mm_T2.T3, Lingual_3mm_T2_T4=data$Lingual_3mm_T2.T4, Lingual_3mm_T2_T5=data$Lingual_3mm_T2.T5, Lingual_3mm_T2_T6=data$Lingual_3mm_T2.T6, Vertical_mid_T2_T1=data$Vertical_mid_T2.T1, Vertical_mid_T2_T3=data$Vertical_mid_T2.T3, Vertical_mid_T2_T4=data$Vertical_mid_T2.T4, Vertical_mid_T2_T5=data$Vertical_mid_T2.T5, Vertical_mid_T2_T6=data$Vertical_mid_T2.T6, Vertical_max_T2_T1=data$Vertical_max_T2.T1, Vertical_max_T2_T3=data$Vertical_max_T2.T3, Vertical_max_T2_T4=data$Vertical_max_T2.T4, Vertical_max_T2_T5=data$Vertical_max_T2.T5, Vertical_max_T2_T6=data$Vertical_max_T2.T6, X.Vol_T2.T1.T1=data$X.Vol_T2.T1.T1, X.Vol_T3.T2.T2=data$X.Vol_T3.T2.T2, X.Vol_T4.T2.T2=data$X.Vol_T4.T2.T2,  X.Vol_T5.T2.T2=data$X.Vol_T5.T2.T2,  X.Vol_T6.T2.T2=data$X.Vol_T6.T2.T2, VAS_pain_T3_minus_T1=data$VAS_pain_T3-data$VAS_pain_T1, 
VAS_pain_T4_minus_T1=data$VAS_pain_T4-data$VAS_pain_T1, 
VAS_pain_T5_minus_T1=data$VAS_pain_T5-data$VAS_pain_T1, 
VAS_pain_T6_minus_T1=data$VAS_pain_T6-data$VAS_pain_T1, 
VAS_swell_T3_minus_T1=data$VAS_swell_T3-data$VAS_swell_T1,
VAS_swell_T4_minus_T1=data$VAS_swell_T4-data$VAS_swell_T1, 
VAS_swell_T5_minus_T1=data$VAS_swell_T5-data$VAS_swell_T1,
VAS_swell_T6_minus_T1=data$VAS_swell_T6-data$VAS_swell_T1, 
VAS_mouth_open_T3_minus_T1=data$VAS_mouth_open_T3-data$VAS_mouth_open_T1, VAS_mouth_open_T4_minus_T1=data$VAS_mouth_open_T4-data$VAS_mouth_open_T1, VAS_mouth_open_T5_minus_T1=data$VAS_mouth_open_T5-data$VAS_mouth_open_T1, VAS_mouth_open_T6_minus_T1=data$VAS_mouth_open_T6-data$VAS_mouth_open_T1,
OHIP_T3_minus_T1=data$OHIP_T3-data$OHIP_T1, 
OHIP_T4_minus_T1=data$OHIP_T4-data$OHIP_T1, 
OHIP_T5_minus_T1=data$OHIP.T5-data$OHIP_T1, 
OHIP_T6_minus_T1=data$OHIP_T6-data$OHIP_T1)
################ compute p values 
cormat2=round(cor(sub_data, method="pearson"),2)
cormat2_pvalue=matrix(nrow=nrow(cormat2), ncol=nrow(cormat2))
for (i in 1:nrow(cormat2))
  for (j in 1:ncol(cormat2))
    cormat2_pvalue[i,j]=round(cor.test(sub_data[,i], sub_data[,j], method="pearson")$p.value,4)
row.names(cormat2_pvalue)=rownames(cormat2) 
colnames(cormat2_pvalue)=rownames(cormat2) 
################
cormat_with_lables <- round(cor(sub_data),2)
sub_data_col_names=colnames(sub_data)
colnames(sub_data)=seq(1:length(sub_data_col_names))
  cormat <- round(cor(sub_data),2)
  
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
  upper_tri <- get_upper_tri(cormat)
  
melted_cormat <- melt(cormat)
melted_cormat_with_labels=melt(cormat_with_lables)

# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
var_index=seq(1,length(sub_data_col_names), by=3)
var_index2=1:length(sub_data_col_names)
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
  #theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1))+
  scale_x_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
  scale_y_continuous("var_index", labels = as.character(var_index), breaks = var_index)#+
 #coord_fixed()

correlation_pvalue=matrix(paste(cormat2, cormat2_pvalue, sep="_"), nrow=nrow(cormat2))
rownames(correlation_pvalue)=row.names(cormat2)
colnames(correlation_pvalue)=row.names(cormat2)
############################
#ggplot(data = melted_cormat_with_labels, aes(Var2, Var1, fill = value))+
# geom_tile(color = "white")+
# scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
#   midpoint = 0, limit = c(-1,1), space = "Lab", 
#   name="Pearson\nCorrelation") +
#  theme_minimal()+ 
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, 
#    size = 10, hjust = 0.5))+
# coord_fixed()


#write.csv(correlation_pvalue, file="../../2022/202209/Juan/Juan_correlation_matrix_pvalue_2023_0526.csv")
#cormat2%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))

#data.frame(var_index=var_index2, variables=sub_data_col_names)%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))
```


* [pearson correlation matrix and p values](https://marq-my.sharepoint.com/:x:/g/personal/shengtong_han_marquette_edu/Eb2oK4OiyU9Fq6qXC3h3ic0BbmmuLd1_K0SNR9L6MK2V7A?e=m603Cq), i.e. `correlation_pvalue`. 

* `NA` in the correlation matrix means one of variables is constant, no variations leading to meaningless correlation. 

* `var_index` corresponds to row/column index in the correlation matrix 



### non-parametric spearman correlation 


#### correlation matrix 1 


```{r, echo=F, message=F, warning=F}
library(reshape2)
sub_data=data.frame(Ging_width_T1=data$Ging_width_T1, Ging_width_T6=data$Ging_width_T6, Ging_thick=data$Ging_thick, Muc_thick=data$Muc_thick,Wound_open_bl_T3=data$Wound_open_bl_T3, Wound_open_bl_T4=data$Wound_open_bl_T4, Wound_open_bl_T5=data$Wound_open_bl_T5, Wound_open_bl_T6=data$Wound_open_bl_T6,Width_3mm_T1=data$Width_3mm_T1
,Width_3mm_T2=data$Width_3mm_T2, Width_3mm_T3=data$width_3mm_T3, Width_3mm_T4=data$Width_3mm_T4,
Width_3mm_T5=data$Width_3mm_T5, Width_3mm_T6=data$Width_3mm_T6, Width_diff_3mm_T2_T1=data$Width_diff_3mm_T2.T1, Width_diff_3mm_T3_T2=data$Width_diff_3mm_T3.T2, Width_diff_3mm_T4_T2=data$Width_diff_3mm_T4.T2, Width_diff_3mm_T5_T2=data$Width_diff_3mm_T5.T2, Width_diff_3mm_T6_T2=data$width_diff_3mm_T6.T2, Buccal_3mm_T2_T1=data$Buccal_3mm_T2.T1, Buccal_3mm_T2_T3=data$Buccal_3mm_T2.T3, Buccal_3mm_T2_T4=data$Buccal_3mm_T2.T4, Buccal_3mm_T2_T5=data$Buccal_3mm_T2.T5, Buccal_3mm_T2_T6=data$Buccal_3mm_T2.T6, Lingual_3mm_T2_T1=data$Lingual_3mm_T2.T1, Lingual_3mm_T2_T3=data$Lingual_3mm_T2.T3, Lingual_3mm_T2_T4=data$Lingual_3mm_T2.T4, Lingual_3mm_T2_T5=data$Lingual_3mm_T2.T5, Lingual_3mm_T2_T6=data$Lingual_3mm_T2.T6, Vertical_mid_T2_T1=data$Vertical_mid_T2.T1, Vertical_mid_T2_T3=data$Vertical_mid_T2.T3, Vertical_mid_T2_T4=data$Vertical_mid_T2.T4, Vertical_mid_T2_T5=data$Vertical_mid_T2.T5, Vertical_mid_T2_T6=data$Vertical_mid_T2.T6, Vertical_max_T2_T1=data$Vertical_max_T2.T1, Vertical_max_T2_T3=data$Vertical_max_T2.T3, Vertical_max_T2_T4=data$Vertical_max_T2.T4, Vertical_max_T2_T5=data$Vertical_max_T2.T5, Vertical_max_T2_T6=data$Vertical_max_T2.T6, X.Vol_T2.T1.T1=data$X.Vol_T2.T1.T1, X.Vol_T3.T2.T2=data$X.Vol_T3.T2.T2, X.Vol_T4.T2.T2=data$X.Vol_T4.T2.T2,  X.Vol_T5.T2.T2=data$X.Vol_T5.T2.T2,  X.Vol_T6.T2.T2=data$X.Vol_T6.T2.T2, VAS_pain_T1=data$VAS_pain_T1, VAS_pain_T3=data$VAS_pain_T3, VAS_pain_T4=data$VAS_pain_T4, VAS_pain_T5=data$VAS_pain_T5, VAS_pain_T6=data$VAS_pain_T6, VAS_swell_T1=data$VAS_swell_T1,VAS_swell_T3=data$VAS_swell_T3, VAS_swell_T4=data$VAS_swell_T4, VAS_swell_T5=data$VAS_swell_T5, VAS_swell_T6=data$VAS_swell_T6, VAS_mouth_open_T1=data$VAS_mouth_open_T1, VAS_mouth_open_T3=data$VAS_mouth_open_T3, VAS_mouth_open_T4=data$VAS_mouth_open_T4, VAS_mouth_open_T5=data$VAS_mouth_open_T5, VAS_mouth_open_T6=data$VAS_mouth_open_T6, OHIP_T1=data$OHIP_T1, OHIP_T3=data$OHIP_T3, OHIP_T4=data$OHIP_T4, OHIP_T5=data$OHIP.T5, OHIP_T6=data$OHIP_T6)
################ compute p values 
cormat2=round(cor(sub_data, method="spearman"),2)
cormat2_pvalue=matrix(nrow=nrow(cormat2), ncol=nrow(cormat2))
for (i in 1:nrow(cormat2))
  for (j in 1:ncol(cormat2))
    cormat2_pvalue[i,j]=round(cor.test(sub_data[,i], sub_data[,j], method="spearman")$p.value,4)
row.names(cormat2_pvalue)=rownames(cormat2) 
colnames(cormat2_pvalue)=rownames(cormat2) 
################
cormat_with_lables <- round(cor(sub_data),2)
sub_data_col_names=colnames(sub_data)
colnames(sub_data)=seq(1:length(sub_data_col_names))
  cormat <- round(cor(sub_data),2)
  
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
  upper_tri <- get_upper_tri(cormat)
  
melted_cormat <- melt(cormat)
melted_cormat_with_labels=melt(cormat_with_lables)

# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
var_index=seq(1,length(sub_data_col_names), by=3)
var_index2=1:length(sub_data_col_names)
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="spearman\nCorrelation") +
  #theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1))+
  scale_x_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
  scale_y_continuous("var_index", labels = as.character(var_index), breaks = var_index)#+
 #coord_fixed()

correlation_pvalue=matrix(paste(cormat2, cormat2_pvalue, sep="_"), nrow=nrow(cormat2))
rownames(correlation_pvalue)=row.names(cormat2)
colnames(correlation_pvalue)=row.names(cormat2)
############################
#ggplot(data = melted_cormat_with_labels, aes(Var2, Var1, fill = value))+
# geom_tile(color = "white")+
# scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
#   midpoint = 0, limit = c(-1,1), space = "Lab", 
#   name="Pearson\nCorrelation") +
#  theme_minimal()+ 
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, 
#    size = 10, hjust = 0.5))+
# coord_fixed()


#write.csv(cormat2, file="../../2022/202209/Juan/Juan_spearman_correlation_matrix_2023_0518.csv")
#write.csv(cormat2_pvalue, file="../../2022/202209/Juan/Juan_spearman_correlation_matrix_pvalue_2023_0518.csv")
#write.csv(correlation_pvalue, file="../../2022/202209/Juan/Juan_spearman_correlation_matrix_pvalue_2023_0518.csv")
#cormat2%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))

#data.frame(var_index=var_index2, variables=sub_data_col_names)%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))
```



```{r, echo=F, message=F, warning=F, eval=F}
library(heatmaply)

heatmaply_cor(
  cor(sub_data),
  xlab = "Features", 
  ylab = "Features",
  na.rm=T
)


df <- mtcars
heatmaply_cor(
  cor(df),
  xlab = "Features", 
  ylab = "Features"
)
```



* [spearman correlation matrix and p values](https://marq-my.sharepoint.com/:x:/g/personal/shengtong_han_marquette_edu/EWwblT_WNiZAvUlf45jHbj8BTW202m50FsaI4XiP2xZcVw?e=jTk3g1), i.e. `correlation_pvalue`. 

* `NA` in the correlation matrix means one of variables is constant, no variations leading to meaningless correlation. 

* `var_index` corresponds to row/column index in the correlation matrix 



#### correlation matrix 2 



```{r, echo=F, message=F, warning=F}
library(reshape2)
sub_data=data.frame(Width_diff_3mm_T2_T1=data$Width_diff_3mm_T2.T1, Width_diff_3mm_T3_T2=data$Width_diff_3mm_T3.T2, Width_diff_3mm_T4_T2=data$Width_diff_3mm_T4.T2, Width_diff_3mm_T5_T2=data$Width_diff_3mm_T5.T2, Width_diff_3mm_T6_T2=data$width_diff_3mm_T6.T2, Buccal_3mm_T2_T1=data$Buccal_3mm_T2.T1, Buccal_3mm_T2_T3=data$Buccal_3mm_T2.T3, Buccal_3mm_T2_T4=data$Buccal_3mm_T2.T4, Buccal_3mm_T2_T5=data$Buccal_3mm_T2.T5, Buccal_3mm_T2_T6=data$Buccal_3mm_T2.T6, Lingual_3mm_T2_T1=data$Lingual_3mm_T2.T1, Lingual_3mm_T2_T3=data$Lingual_3mm_T2.T3, Lingual_3mm_T2_T4=data$Lingual_3mm_T2.T4, Lingual_3mm_T2_T5=data$Lingual_3mm_T2.T5, Lingual_3mm_T2_T6=data$Lingual_3mm_T2.T6, Vertical_mid_T2_T1=data$Vertical_mid_T2.T1, Vertical_mid_T2_T3=data$Vertical_mid_T2.T3, Vertical_mid_T2_T4=data$Vertical_mid_T2.T4, Vertical_mid_T2_T5=data$Vertical_mid_T2.T5, Vertical_mid_T2_T6=data$Vertical_mid_T2.T6, Vertical_max_T2_T1=data$Vertical_max_T2.T1, Vertical_max_T2_T3=data$Vertical_max_T2.T3, Vertical_max_T2_T4=data$Vertical_max_T2.T4, Vertical_max_T2_T5=data$Vertical_max_T2.T5, Vertical_max_T2_T6=data$Vertical_max_T2.T6, X.Vol_T2.T1.T1=data$X.Vol_T2.T1.T1, X.Vol_T3.T2.T2=data$X.Vol_T3.T2.T2, X.Vol_T4.T2.T2=data$X.Vol_T4.T2.T2,  X.Vol_T5.T2.T2=data$X.Vol_T5.T2.T2,  X.Vol_T6.T2.T2=data$X.Vol_T6.T2.T2, VAS_pain_T3_minus_T1=data$VAS_pain_T3-data$VAS_pain_T1, 
VAS_pain_T4_minus_T1=data$VAS_pain_T4-data$VAS_pain_T1, 
VAS_pain_T5_minus_T1=data$VAS_pain_T5-data$VAS_pain_T1, 
VAS_pain_T6_minus_T1=data$VAS_pain_T6-data$VAS_pain_T1, 
VAS_swell_T3_minus_T1=data$VAS_swell_T3-data$VAS_swell_T1,
VAS_swell_T4_minus_T1=data$VAS_swell_T4-data$VAS_swell_T1, 
VAS_swell_T5_minus_T1=data$VAS_swell_T5-data$VAS_swell_T1,
VAS_swell_T6_minus_T1=data$VAS_swell_T6-data$VAS_swell_T1, 
VAS_mouth_open_T3_minus_T1=data$VAS_mouth_open_T3-data$VAS_mouth_open_T1, VAS_mouth_open_T4_minus_T1=data$VAS_mouth_open_T4-data$VAS_mouth_open_T1, VAS_mouth_open_T5_minus_T1=data$VAS_mouth_open_T5-data$VAS_mouth_open_T1, VAS_mouth_open_T6_minus_T1=data$VAS_mouth_open_T6-data$VAS_mouth_open_T1,
OHIP_T3_minus_T1=data$OHIP_T3-data$OHIP_T1, 
OHIP_T4_minus_T1=data$OHIP_T4-data$OHIP_T1, 
OHIP_T5_minus_T1=data$OHIP.T5-data$OHIP_T1, 
OHIP_T6_minus_T1=data$OHIP_T6-data$OHIP_T1)
################ compute p values 
cormat2=round(cor(sub_data, method="spearman"),2)
cormat2_pvalue=matrix(nrow=nrow(cormat2), ncol=nrow(cormat2))
for (i in 1:nrow(cormat2))
  for (j in 1:ncol(cormat2))
    cormat2_pvalue[i,j]=round(cor.test(sub_data[,i], sub_data[,j], method="spearman")$p.value,4)
row.names(cormat2_pvalue)=rownames(cormat2) 
colnames(cormat2_pvalue)=rownames(cormat2) 
################
cormat_with_lables <- round(cor(sub_data),2)
sub_data_col_names=colnames(sub_data)
colnames(sub_data)=seq(1:length(sub_data_col_names))
  cormat <- round(cor(sub_data),2)
  
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
  upper_tri <- get_upper_tri(cormat)
  
melted_cormat <- melt(cormat)
melted_cormat_with_labels=melt(cormat_with_lables)

# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
var_index=seq(1,length(sub_data_col_names), by=3)
var_index2=1:length(sub_data_col_names)
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Spearman\nCorrelation") +
  #theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1))+
  scale_x_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
  scale_y_continuous("var_index", labels = as.character(var_index), breaks = var_index)#+
 #coord_fixed()

correlation_pvalue=matrix(paste(cormat2, cormat2_pvalue, sep="_"), nrow=nrow(cormat2))
rownames(correlation_pvalue)=row.names(cormat2)
colnames(correlation_pvalue)=row.names(cormat2)
############################
#ggplot(data = melted_cormat_with_labels, aes(Var2, Var1, fill = value))+
# geom_tile(color = "white")+
# scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
#   midpoint = 0, limit = c(-1,1), space = "Lab", 
#   name="Pearson\nCorrelation") +
#  theme_minimal()+ 
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, 
#    size = 10, hjust = 0.5))+
# coord_fixed()


#write.csv(correlation_pvalue, file="../../2022/202209/Juan/Juan_spearman_correlation_matrix_pvalue_2023_0526.csv")
#cormat2%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))

#data.frame(var_index=var_index2, variables=sub_data_col_names)%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))
```



* [spearman correlation matrix and p values](https://marq-my.sharepoint.com/:x:/g/personal/shengtong_han_marquette_edu/Ef3kQ1eaHTdPuMcfVUSrycoBHiLXZcTpozzLHDNHEeP6TQ?e=qYDAGm), i.e. `correlation_pvalue`. 

* `NA` in the correlation matrix means one of variables is constant, no variations leading to meaningless correlation. 

* `var_index` corresponds to row/column index in the correlation matrix 


## regression analysis 

### model  1.	Dependent variables: % volume (Tx-T2/T2)

```{r, echo=F, message=F, warning=F}
response_var=c("X.Vol_T3.T2.T2", "X.Vol_T4.T2.T2", "X.Vol_T5.T2.T2", "X.Vol_T6.T2.T2")
predictors=data.frame(vertical_mid=c("Vertical_mid_T2.T3", "Vertical_mid_T2.T4", "Vertical_mid_T2.T5", "Vertical_mid_T2.T6"), width_diff=c("Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2"))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(), vertical_mid=data %>% select(predictors$vertical_mid[i]) %>% pull(), width_diff=data %>% select(predictors$width_diff[i]) %>% pull())
  regress_model=lm(response~vertical_mid+width_diff, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="T3-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="T4-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="T5-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="T6-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

######################
#ggplot(data = regress_data, aes(x = vertical_mid+width_diff, y = response)) +
#  stat_poly_line() +
#  stat_poly_eq(aes(label = paste(after_stat(eq.label),
#                                 after_stat(rr.label), sep = "*\", \"*"))) +
#  geom_point()
```


### model 2.	Dependent variables: % volume (Tx-T2/T2)


```{r, echo=F, message=F, warning=F}
response_var=c("X.Vol_T3.T2.T2", "X.Vol_T4.T2.T2", "X.Vol_T5.T2.T2", "X.Vol_T6.T2.T2")
predictors=data.frame(vertical_max=c("Vertical_max_T2.T3", "Vertical_max_T2.T4", "Vertical_max_T2.T5", "Vertical_max_T2.T6"), width_diff=c("Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2"))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(), vertical_max=data %>% select(predictors$vertical_max[i]) %>% pull(), width_diff=data %>% select(predictors$width_diff[i]) %>% pull())
  regress_model=lm(response~vertical_max+width_diff, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="T3-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="T4-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="T5-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="T6-T2/T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

######################
#ggplot(data = regress_data, aes(x = vertical_mid+width_diff, y = response)) +
#  stat_poly_line() +
#  stat_poly_eq(aes(label = paste(after_stat(eq.label),
#                                 after_stat(rr.label), sep = "*\", \"*"))) +
#  geom_point()
```

### model 3.	Dependent variables: wound opening T3, T4, T5, T6


```{r, echo=F, message=F, warning=F}
response_var=c("Wound_open_bl_T3", "Wound_open_bl_T4", "Wound_open_bl_T5", "Wound_open_bl_T6")
predictors=data.frame(vertical_max=c("Vertical_max_T2.T3", "Vertical_max_T2.T4", "Vertical_max_T2.T5", "Vertical_max_T2.T6"), width_diff=c("Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2"), Ging_thick=rep("Ging_thick", 4), Muc_thick=rep("Muc_thick", 4), Duration=rep("Duration.min.", 4))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(), vertical_max=data %>% select(predictors$vertical_max[i]) %>% pull(), width_diff=data %>% select(predictors$width_diff[i]) %>% pull(), Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~vertical_max+width_diff+Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

######################
#ggplot(data = regress_data, aes(x = vertical_mid+width_diff, y = response)) +
#  stat_poly_line() +
#  stat_poly_eq(aes(label = paste(after_stat(eq.label),
#                                 after_stat(rr.label), sep = "*\", \"*"))) +
#  geom_point()
```


### model 4.	Dependent variables: wound opening T3, T4, T5, T6


```{r, echo=F, message=F, warning=F}
response_var=c("Wound_open_bl_T3", "Wound_open_bl_T4", "Wound_open_bl_T5", "Wound_open_bl_T6")
predictors=data.frame(vertical_mid=c("Vertical_mid_T2.T3", "Vertical_mid_T2.T4", "Vertical_mid_T2.T5", "Vertical_mid_T2.T6"), width_diff=c("Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2"), Ging_thick=rep("Ging_thick", 4), Muc_thick=rep("Muc_thick", 4), Duration=rep("Duration.min.", 4))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(), vertical_mid=data %>% select(predictors$vertical_mid[i]) %>% pull(), width_diff=data %>% select(predictors$width_diff[i]) %>% pull(), Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~vertical_mid+width_diff+Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

######################
#ggplot(data = regress_data, aes(x = vertical_mid+width_diff, y = response)) +
#  stat_poly_line() +
#  stat_poly_eq(aes(label = paste(after_stat(eq.label),
#                                 after_stat(rr.label), sep = "*\", \"*"))) +
#  geom_point()
```


### model 5.	Dependent variables: wound opening T3, T4, T5, T6


```{r, echo=F, message=F, warning=F}
response_var=c("Wound_open_bl_T3", "Wound_open_bl_T4", "Wound_open_bl_T5", "Wound_open_bl_T6")
predictors=data.frame(volume=c("X.Vol_T3.T2.T2", "X.Vol_T4.T2.T2", "X.Vol_T5.T2.T2", "X.Vol_T6.T2.T2"), Ging_thick=rep("Ging_thick", 4), Muc_thick=rep("Muc_thick", 4), Duration=rep("Duration.min.", 4))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(), volume=data%>% select(predictors$volume[i])%>%pull(), Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~volume+Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

######################
#ggplot(data = regress_data, aes(x = vertical_mid+width_diff, y = response)) +
#  stat_poly_line() +
#  stat_poly_eq(aes(label = paste(after_stat(eq.label),
#                                 after_stat(rr.label), sep = "*\", \"*"))) +
#  geom_point()
```


## Multiple regression analysis - Swelling


### model 1 

#### Width_diff


```{r, echo=F, message=F, warning=F}
response_var=c("Width_diff_3mm_T2.T1", "Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T3.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T4.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T5.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T6.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```

#### Buccal 


```{r, echo=F, message=F, warning=F}
response_var=c("Buccal_3mm_T2.T1", "Buccal_3mm_T2.T3", "Buccal_3mm_T2.T4", "Buccal_3mm_T2.T5", "Buccal_3mm_T2.T6")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Buccal_3mm_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Buccal_3mm_T2.T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Buccal_3mm_T2.T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Buccal_3mm_T2.T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Buccal_3mm_T2.T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```


#### Lingual 


```{r, echo=F, message=F, warning=F}
response_var=c("Lingual_3mm_T2.T1", "Lingual_3mm_T2.T3", "Lingual_3mm_T2.T4", "Lingual_3mm_T2.T5", "Lingual_3mm_T2.T6")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Lingual_3mm_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Lingual_3mm_T2.T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Lingual_3mm_T2.T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Lingual_3mm_T2.T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Lingual_3mm_T2.T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```




#### Vertical_mid


```{r, echo=F, message=F, warning=F}
response_var=c("Vertical_mid_T2.T1", "Vertical_mid_T2.T3", "Vertical_mid_T2.T4", "Vertical_mid_T2.T5", "Vertical_mid_T2.T6")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_mid_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_mid_T2.T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_mid_T2.T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_mid_T2.T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_mid_T2.T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```


#### Vertical_max


```{r, echo=F, message=F, warning=F}
response_var=c("Vertical_max_T2.T1", "Vertical_max_T2.T3", "Vertical_max_T2.T4", "Vertical_max_T2.T5", "Vertical_max_T2.T6")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_max_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_max_T2.T3",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_max_T2.T4",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_max_T2.T5",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Vertical_max_T2.T6",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```



#### %vol 


```{r, echo=F, message=F, warning=F}
response_var=c("X.Vol_T2.T1.T1", "X.Vol_T3.T2.T2", "X.Vol_T4.T2.T2", "X.Vol_T5.T2.T2", "X.Vol_T6.T2.T2")
predictors=data.frame( Ging_thick=rep("Ging_thick", 5), Muc_thick=rep("Muc_thick", 5), Duration=rep("Duration.min.", 5))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Muc_thick=data%>% select(predictors$Muc_thick)%>%pull(), Ging_thick=data%>% select(predictors$Ging_thick)%>%pull(), Duration=data%>% select(predictors$Duration)%>%pull())
  regress_model=lm(response~Muc_thick+Ging_thick+Duration, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="X.Vol_T2.T1.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="X.Vol_T3.T2.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="X.Vol_T4.T2.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="X.Vol_T5.T2.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="X.Vol_T6.T2.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```



### model 2 



```{r, echo=F, message=F, warning=F}
response_var=c("Width_diff_3mm_T2.T1", "Width_diff_3mm_T3.T2", "Width_diff_3mm_T4.T2", "Width_diff_3mm_T5.T2", "width_diff_3mm_T6.T2")
predictors=data.frame(Buccal_3mm=c("Buccal_3mm_T2.T1", "Buccal_3mm_T2.T3", "Buccal_3mm_T2.T4", "Buccal_3mm_T2.T5", "Buccal_3mm_T2.T6"), Lingual_3mm=c("Lingual_3mm_T2.T1", "Lingual_3mm_T2.T3", "Lingual_3mm_T2.T4", "Lingual_3mm_T2.T5", "Lingual_3mm_T2.T6"))
regression_coefficient=list()
for (i in 1:length(response_var))
{
  regress_data=data.frame(response=data %>% select(response_var[i]) %>% pull(),  Buccal_3mm=data%>% select(predictors$Buccal_3mm)%>%pull(), Lingual_3mm=data%>% select(predictors$Lingual_3mm)%>%pull())
  regress_model=lm(response~Buccal_3mm+Lingual_3mm, data=regress_data)
  regression_coefficient[[i]]=round(summary(regress_model)$coefficients,4)
}
regression_coefficient[[1]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T2.T1",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[2]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T3.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[3]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T4.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


regression_coefficient[[4]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T5.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

regression_coefficient[[5]]%>%
datatable(extensions = 'Buttons',
          caption="Width_diff_3mm_T6.T2",
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


```

## statistical software 

```{r, echo=F}
R.version
```