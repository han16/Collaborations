---
title: "9/14/2022"
output: html_document
date: '2022-09-14'
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(ggpubr)
library(rstatix) # use anova_test function 
library(DT)
set.seed(123)
```


```{r, echo=F, warning=F, message=F}
pvalue_adjust=function(p_value)
{
  p_value_adjust=numeric()
for (i in 1:length(p_value))
{
  if (is.na(p_value[i])==T)
    p_value_adjust[i]=p_value[i]
  if (is.na(p_value[i])==F & p_value[i]<0.0001)
    p_value_adjust[i]="<0.0001"
  if (is.na(p_value[i])==F & p_value[i]>0.0001)
    p_value_adjust[i]=round(p_value[i],4)
}
  return(p_value_adjust)
}
data=as_tibble(read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\Research Valencia-Kofina implants final n=26.csv"))
old_data=as_tibble(read.csv("C:\\Shengtong\\Research\\AllCollaboration\\2022\\202209\\Juan\\Research Valencia-Kofina implants.csv"))
```

## Distribution of variables 

### Age 

```{r, echo=F, message=F, warning=F}
p=ggplot(data.frame(var=rep("Age", 26), Age=data$Age), aes(x=var, y=Age))+
  geom_boxplot()
p+geom_dotplot(binaxis='y', stackdir='center', dotsize=0.6)+
  ggtitle("boxplot of Age")+
  theme(plot.title = element_text(hjust = 0.5, size=15)) # center the title


#round(mean(data$Age),2) # mean 
#round(sd(data$Age),2)  # sd 
#round(sd(data$Age)/sqrt(nrow(data)),2) # se
#min(data$Age) # minimum 
#max(data$Age) # maximum 
```




| Mean      | SD |   SE    | Range
| :---        |    :----:   |   :----:   |        ---: |
| 54.15    | 16.55   | 3.25   | (27, 73) |



### Gender 

```{r, echo=F, message=F, warning=F}
g1=ggplot(data %>% count(Gender) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Gender), y=prop, fill=as.factor(Gender))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Gender (%)")+ylim(c(0,1))+
  xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Gender), aes(x=as.factor(Gender), y=n, fill=as.factor(Gender))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Gender")+
  xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

#gender_count=data %>% count(Gender) %>% select(n) %>% pull
#binom.test(gender_count[1], sum(gender_count), p = 0.5)
```

* large p value of 0.845 suggests no difference between gender. 


### Race 


```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Race) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Race), y=prop, fill=as.factor(Race))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Race (%)")+ylim(c(0,1))+
  xlab("Race: 1=white, 2=Hispanic, 5=African American")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Race), aes(x=as.factor(Race), y=n, fill=as.factor(Race))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Race")+
  xlab("Race: 1=white, 2=Hispanic, 5=African American")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* sample size is not large enough to test the difference 


### Site 


```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Site) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Site), y=prop, fill=as.factor(Site))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Site")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Site), aes(x=as.factor(Site), y=n, fill=as.factor(Site))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Site")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* many sites have too few counts (<10) to test the difference 

###  Type_bone_graft 



```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Type_bone_graft) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Type_bone_graft), y=prop, fill=as.factor(Type_bone_graft))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Type_bone_graft")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Type_bone_graft), aes(x=as.factor(Type_bone_graft), y=n, fill=as.factor(Type_bone_graft))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Type_bone_graft")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```

* numbers are too small (<10) to test the difference



###  Exp_level



```{r, echo=F, warning=F, message=F}
g1=ggplot(data %>% count(Exp_level) %>%mutate(prop=n/nrow(data)), aes(x=as.factor(Exp_level), y=prop, fill=as.factor(Exp_level))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Proportion (%)")+
  #ylim(c(0,1))+
  xlab("Exp_level")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g2=ggplot(data %>% count(Exp_level), aes(x=as.factor(Exp_level), y=n, fill=as.factor(Exp_level))) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("Count (#)")+
  xlab("Exp_level")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure

```


* numbers are too small (<10) to test the difference



## summary statistics 


```{r, echo=F, message=F, warning=F}
sub_data=data.frame(Age=data$Age, Time_bone_graft=data$Type_bone_graft, Ging_thick=data$Ging_thick, Muc_thick=data$Muc_thick, Duration_min=data$Duration.min., Suture_removal=data$Suture_removal, Ging_width_T1=data$Ging_width_T1, Ging_width_T6=data$Ging_width_T6)
Mean=numeric()
SD=numeric()
SE=numeric()
range_min=numeric()
range_max=numeric()
for (i in 1:ncol(sub_data))
{
  Mean[i]=round(mean(sub_data[,i]),4)
  SD[i]=round(sd(sub_data[,i]),4)
  SE[i]=round(SD[i]/sqrt(nrow(sub_data)),4)
  range_min[i]=round(min(sub_data[,i]),4)
  range_max[i]=round(max(sub_data[,i]),4)
}

data.frame(Time=c("Age", "Time_bone_graft", "Ging_thick", "Muc_thick", "Duration(min)", "Suture_removal", "Ging_width_T1", "Ging_width_T6"), Mean=Mean, SD=SD, SE=SE, Range_low=range_min, Range_upper=range_max)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

# t.test(data$Ging_width_T1, data$Ging_width_T6, paired=T) # use paired t test to test the difference 
```

* p value of 0.7824 suggests no difference between `Ging_width_T1` and `Ging_width_T6`


## Width_3mm


### trajectory plot

```{r, echo=F, message=F, warning=F}
data_long=data.frame(Width_3mm=c(data$Width_3mm_T1, data$Width_3mm_T2, data$width_3mm_T3, data$Width_3mm_T4, data$Width_3mm_T5, data$Width_3mm_T6), time=rep(c("T1", "T2", "T3", "T4", "T5", "T6"), each=nrow(data)), individual=rep(data$Subject,6))

g1=ggplot(data=data_long,aes(x=time, y=Width_3mm, group=individual))+
  geom_line(color="red")+
  geom_point() # look at total PBI 


g2=ggplot(data.frame(Width_3mm_mean=c(mean(data$Width_3mm_T1),mean(data$Width_3mm_T2), mean(data$width_3mm_T3), mean(data$Width_3mm_T4), mean(data$Width_3mm_T5), mean(data$Width_3mm_T6)), time=c("T1", "T2", "T3", "T4", "T5", "T6")), aes(x=time, y=Width_3mm_mean, group=1))+
  ylim(c(min(data_long$Width_3mm), max(data_long$Width_3mm)))+
  geom_line(color="red")+
  geom_point()

figure <- ggarrange(g1, g2,
                   # labels = c("A", "B", "C"),
                    ncol = 2, nrow = 1)
figure 

# data_long %>% filter(time=="T1") %>% summarise(mean=round(mean(Width_3mm),4), SD=round(sd(Width_3mm),4), se=round(SD/23,4), min=round(min(Width_3mm),4), max=round(max(Width_3mm), 4)) 
```


```{r, echo=F, message=F, warning=F}
Width_3mm_data=matrix(nrow=nrow(data), ncol=6)
Width_3mm_data[,1]=data_long %>% filter(time=="T1") %>% select(Width_3mm) %>% pull
Width_3mm_data[,2]=data_long %>% filter(time=="T2") %>% select(Width_3mm) %>% pull
Width_3mm_data[,3]=data_long %>% filter(time=="T3") %>% select(Width_3mm) %>% pull
Width_3mm_data[,4]=data_long %>% filter(time=="T4") %>% select(Width_3mm) %>% pull
Width_3mm_data[,5]=data_long %>% filter(time=="T5") %>% select(Width_3mm) %>% pull
Width_3mm_data[,6]=data_long %>% filter(time=="T6") %>% select(Width_3mm) %>% pull
Mean=numeric(); SD=numeric(); SE=numeric(); Range_low=numeric(); Range_upper=numeric()
for (i in 1:6)
{
  Mean[i]=round(mean(Width_3mm_data[,i]),4)
  SD[i]=round(sd(Width_3mm_data[,i]),4)
  SE[i]=round(SD[i]/sqrt(nrow(data)),4)
  Range_low[i]=round(min(Width_3mm_data[,i]),4)
  Range_upper[i]=round(max(Width_3mm_data[,i]),4)
}

data.frame(Time=c("T1", "T2", "T3", "T4", "T5", "T6"), Mean=Mean, SD=SD, SE=SE, Range_low=Range_low, Range_upper=Range_upper)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```




### pairwise comparisons




```{r, echo=F, message=F, warning=F}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:6)
 for (j in 1:6)
{
  ii=ii+1
  samplei=data[,(5+i)] %>% pull
  samplej=data[,(5+j)] %>% pull
  test=t.test(samplei, samplej, paired=T)
  estimate[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
  
  
 }


result=data_frame(group1=rep(colnames(data)[6:11], each=6), group2=rep(colnames(data)[6:11],6), mean_difference=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 
result$group1[c(2:6, 8:12, 14:18, 20:24, 26:30, 32:36)]="---"

result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* use paired two sample t test 


### test different across all time points 

```{r, echo=F, message=F, warning=F}

res.aov <- anova_test(data = data_long, dv =Width_3mm , wid = individual, within = time)
get_anova_table(res.aov)
```


* use repeated anova test 

* small p value indicates significant change over time 

## _T2-T1, T3-T2, T4-T2,  T5-T2 and T6-T2

### Width_diff_3mm





```{r, echo=F, message=F, warning=F}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric(); 
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
# replace data[8,13]=5.4646 by referring to old sample 

for (i in 1:5)
{
  current=data[,(11+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[12:16], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()
```

* use one sample t test to test each parameter is equal to 0 or not





```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(11+i)] %>% pull
  group2=data[,(11+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[12:16],each=5), group2=rep(colnames(data)[12:16],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 
result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


### Buccal_3mm

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(16+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[17:21], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()
```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(16+i)] %>% pull
  group2=data[,(16+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[17:21],each=5), group2=rep(colnames(data)[17:21],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


### Lingual_3mm


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()

for (i in 1:5)
{
  current=data[,(21+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[22:26], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()
```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(21+i)] %>% pull
  group2=data[,(21+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[22:26],each=5), group2=rep(colnames(data)[22:26],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```



###  Vertical_mid


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(26+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[27:31], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```




```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(26+i)] %>% pull
  group2=data[,(26+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[27:31],each=5), group2=rep(colnames(data)[27:31],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```



###  Vertical_max


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(31+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[32:36], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(31+i)] %>% pull
  group2=data[,(31+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[32:36],each=5), group2=rep(colnames(data)[32:36],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


## %vol 


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(44+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[45:49], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(44+i)] %>% pull
  group2=data[,(44+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[45:49],each=5), group2=rep(colnames(data)[45:49],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```


## VAS_pain 

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(49+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[50:54], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(49+i)] %>% pull
  group2=data[,(49+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[50:54],each=5), group2=rep(colnames(data)[50:54],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```



## VAS_swell

```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(54+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[55:59], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(54+i)] %>% pull
  group2=data[,(54+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[55:59],each=5), group2=rep(colnames(data)[55:59],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```

## VAS_mouth_open 



```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(59+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[60:64], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(59+i)] %>% pull
  group2=data[,(59+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[60:64],each=5), group2=rep(colnames(data)[60:64],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


## OHIP 


```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:5)
{
  current=data[,(64+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[65:69], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  group1=data[,(64+i)] %>% pull
  group2=data[,(64+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[65:69],each=5), group2=rep(colnames(data)[65:69],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```

## Wound_open_bl 




```{r, echo=F, message=F, warning=F, eval=T}
p_value=numeric(); estimate=numeric(); CI_lower=numeric(); CI_upper=numeric()
SD=numeric(); SE=numeric(); minimum=numeric(); maximum=numeric()
for (i in 1:4)
{
  current=data[,(69+i)] %>% pull
  test=t.test(current)
  estimate[i]=test$estimate
  CI_lower[i]=test$conf.int[1]
  CI_upper[i]=test$conf.int[2]
  p_value[i]=test$p.value
  
  SD[i]=sd(current)
  SE[i]=SD/length(current)
  minimum[i]=min(current)
  maximum[i]=max(current)
}
data_frame(parameter=colnames(data)[70:73], mean=round(estimate,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value), SD=round(SD,4), SE=round(SE,4),  minimum=round(minimum,4),  maximum=round(maximum, 4))%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()  
```



```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  group1=data[,(69+i)] %>% pull
  group2=data[,(69+j)] %>% pull
  test=t.test(group1, group2, paired=T)
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[70:73],each=4), group2=rep(colnames(data)[70:73],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```

## Wound_open 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Wound_open_T3_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T3_YN, y=prop, fill=Wound_open_T3_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Wound_open_T3_YN), aes(x=Wound_open_T3_YN, y=n, fill=Wound_open_T3_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

################################

g21=ggplot(data %>% count(Wound_open_T4_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T4_YN, y=prop, fill=Wound_open_T4_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Wound_open_T4_YN), aes(x=Wound_open_T4_YN, y=n, fill=Wound_open_T4_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###################################

g31=ggplot(data %>% count(Wound_open_T5_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T5_YN, y=prop, fill=Wound_open_T5_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Wound_open_T5_YN), aes(x=Wound_open_T5_YN, y=n, fill=Wound_open_T5_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################
g41=ggplot(data %>% count(Wound_open_T6_YN) %>%mutate(prop=n/nrow(data)), aes(x=Wound_open_T6_YN, y=prop, fill=Wound_open_T6_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Wound_open_T6_YN), aes(x=Wound_open_T6_YN, y=n, fill=Wound_open_T6_YN)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```






```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(73+i)]=="Y") # No of yes 
  n2=sum(data[,(73+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[74:77],each=4), group2=rep(colnames(data)[74:77],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))
```

* `mean_difference` means the proportion of `Y` between group1 and group 2  


## Bleeding


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Bleeding_T3) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T3, y=prop, fill=Bleeding_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Bleeding_T3), aes(x=Bleeding_T3, y=n, fill=Bleeding_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###############################
g21=ggplot(data %>% count(Bleeding_T4) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T4, y=prop, fill=Bleeding_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Bleeding_T4), aes(x=Bleeding_T4, y=n, fill=Bleeding_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
##################################
g31=ggplot(data %>% count(Bleeding_T5) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T5, y=prop, fill=Bleeding_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Bleeding_T5), aes(x=Bleeding_T5, y=n, fill=Bleeding_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
###############################
g41=ggplot(data %>% count(Bleeding_T6) %>%mutate(prop=n/nrow(data)), aes(x=Bleeding_T6, y=prop, fill=Bleeding_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Bleeding_T6), aes(x=Bleeding_T6, y=n, fill=Bleeding_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 4, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(77+i)]=="Y") # No of yes 
  n2=sum(data[,(77+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[78:81],each=4), group2=rep(colnames(data)[78:81],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2  





## Bruising

```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Bruising_T2) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T2, y=prop, fill=Bruising_T2)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Bruising_T2), aes(x=Bruising_T2, y=n, fill=Bruising_T2)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
############################

g21=ggplot(data %>% count(Bruising_T3) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T3, y=prop, fill=Bruising_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Bruising_T3), aes(x=Bruising_T3, y=n, fill=Bruising_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
######################
g31=ggplot(data %>% count(Bruising_T4) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T4, y=prop, fill=Bruising_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Bruising_T4), aes(x=Bruising_T4, y=n, fill=Bruising_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
#############################
g41=ggplot(data %>% count(Bruising_T5) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T5, y=prop, fill=Bruising_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Bruising_T5), aes(x=Bruising_T5, y=n, fill=Bruising_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

########################
g51=ggplot(data %>% count(Bruising_T6) %>%mutate(prop=n/nrow(data)), aes(x=Bruising_T6, y=prop, fill=Bruising_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g52=ggplot(data %>% count(Bruising_T6), aes(x=Bruising_T6, y=n, fill=Bruising_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,g41,g51,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,g52,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
{
  ii=ii+1
  n1=sum(data[,(81+i)]=="Y") # No of yes 
  n2=sum(data[,(81+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[82:86],each=5), group2=rep(colnames(data)[82:86],5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2 




## Flap_necrosis 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Flap_necrosis_T3) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T3, y=prop, fill=Flap_necrosis_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Flap_necrosis_T3), aes(x=Flap_necrosis_T3, y=n, fill=Flap_necrosis_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 
########################
g21=ggplot(data %>% count(Flap_necrosis_T4) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T4, y=prop, fill=Flap_necrosis_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Flap_necrosis_T4), aes(x=Flap_necrosis_T4, y=n, fill=Flap_necrosis_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#######################
g31=ggplot(data %>% count(Flap_necrosis_T5) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T5, y=prop, fill=Flap_necrosis_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Flap_necrosis_T5), aes(x=Flap_necrosis_T5, y=n, fill=Flap_necrosis_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

######################
g41=ggplot(data %>% count(Flap_necrosis_T6) %>%mutate(prop=n/nrow(data)), aes(x=Flap_necrosis_T6, y=prop, fill=Flap_necrosis_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g42=ggplot(data %>% count(Flap_necrosis_T6), aes(x=Flap_necrosis_T6, y=n, fill=Flap_necrosis_T6)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 


##################################

figure1 <- ggarrange(g11, g21,g31,g41,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,g42,
                   # labels = c("A", "B", "C"),
                    ncol = 5, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)
```


```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:4)
  for (j in 1:4)
{
  ii=ii+1
  n1=sum(data[,(86+i)]=="Y") # No of yes 
  n2=sum(data[,(86+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[87:90],each=4), group2=rep(colnames(data)[87:90],4), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:4, 6:8, 10:12, 14:16)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

* `mean_difference` means the proportion difference of `Y` between group 1 and group 2  





## Loose_sutures 


```{r, echo=F, message=F, warning=F}
g11=ggplot(data %>% count(Loose_Sutures_T3) %>%mutate(prop=n/nrow(data)), aes(x=Loose_Sutures_T3, y=prop, fill=Loose_Sutures_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g12=ggplot(data %>% count(Loose_Sutures_T3), aes(x=Loose_Sutures_T3, y=n, fill=Loose_Sutures_T3)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#############################

g21=ggplot(data %>% count(Loose_sutures_T4) %>%mutate(prop=n/nrow(data)), aes(x=Loose_sutures_T4, y=prop, fill=Loose_sutures_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g22=ggplot(data %>% count(Loose_sutures_T4), aes(x=Loose_sutures_T4, y=n, fill=Loose_sutures_T4)) +geom_bar(stat="identity")+
  theme(legend.position="none")+ylim(c(0,28))+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

#####################
g31=ggplot(data %>% count(Loose_sutures_T5) %>%mutate(prop=n/nrow(data)), aes(x=Loose_sutures_T5, y=prop, fill=Loose_sutures_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("proportion (%)")+ylim(c(0,1.1))+
  #xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=round(prop,3)*100), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

g32=ggplot(data %>% count(Loose_sutures_T5), aes(x=Loose_sutures_T5, y=n, fill=Loose_sutures_T5)) +geom_bar(stat="identity")+
  theme(legend.position="none")+
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, size=10))+
  ylab("count")+ylim(c(0,28))+
 # xlab("Gender: 1=male, 2=female")+
  geom_text(aes(label=n), position=position_dodge(width=0.6), vjust=-0.25)+  # add numbers over bars
  ggtitle("")+
  theme(plot.title = element_text(hjust = 0.5, size=15))  #center the title 

##################################

figure1 <- ggarrange(g11, g21,g31,
                   # labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
annotate_figure(figure1,
                top = text_grob("proportion", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)


figure2 <- ggarrange(g12, g22,g32,
                   # labels = c("A", "B", "C"),
                    ncol = 3, nrow = 1)
annotate_figure(figure2,
                top = text_grob("count", color = "red", face = "bold", size = 14),
#                bottom = text_grob("Datasource: \n ToothGrowth data set", color = "blue",
#                                   hjust = 1, x = 1, face = "italic", size = 10),
#                left = text_grob("Tooth length", color = "green", rot = 90),
#                right = "I'm done, thanks :-)!",
#                fig.lab = "Figure 1", fig.lab.face = "bold"
)

```




```{r, echo=F, message=F, warning=F}
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:3)
  for (j in 1:3)
{
  ii=ii+1
  n1=sum(data[,(90+i)]=="Y") # No of yes 
  n2=sum(data[,(90+j)]=="Y")
  test=prop.test(x=c(n1,n2), n=c(26,26))
  mean_difference[ii]=test$estimate[1]-test$estimate[2]
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(data)[91:93],each=3), group2=rep(colnames(data)[91:93],3), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:3, 5:6, 8:9)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```

## T2-T1 

```{r, echo=F, message=F, warning=F}
T2.T1=data %>% select(ends_with("T2.T1"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T2.T1[,i] %>% pull
  group2=T2.T1[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(T2.T1),each=5), group2=rep(colnames(T2.T1),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


## T3-T2 

```{r, echo=F, message=F, warning=F}
T3.T2=data %>% select(ends_with("T3.T2") | ends_with("T2.T3"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T3.T2[,i] %>% pull
  group2=T3.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(T3.T2),each=5), group2=rep(colnames(T3.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```



## T4-T2 

```{r, echo=F, message=F, warning=F}
T4.T2=data %>% select(ends_with("T4.T2") | ends_with("T2.T4"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T4.T2[,i] %>% pull
  group2=T4.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(T4.T2),each=5), group2=rep(colnames(T4.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


## T5-T2 

```{r, echo=F, message=F, warning=F}
T5.T2=data %>% select(ends_with("T5.T2") | ends_with("T2.T5"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T5.T2[,i] %>% pull
  group2=T5.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(T5.T2),each=5), group2=rep(colnames(T5.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```


## T6-T2 

```{r, echo=F, message=F, warning=F}
T6.T2=data %>% select(ends_with("T6.T2") | ends_with("T2.T6"))
p_value=numeric(); mean_difference=numeric(); CI_lower=numeric(); CI_upper=numeric()
ii=0
for (i in 1:5)
  for (j in 1:5)
  {
  ii=ii+1
  #  i=1; j=1
  group1=T6.T2[,i] %>% pull
  group2=T6.T2[,j] %>% pull
  test=t.test(group1, group2, paired=T) 
  mean_difference[ii]=test$estimate
  CI_lower[ii]=test$conf.int[1]
  CI_upper[ii]=test$conf.int[2]
  p_value[ii]=test$p.value
}
result=data_frame(group1=rep(colnames(T6.T2),each=5), group2=rep(colnames(T6.T2),5), mean_difference=round(mean_difference,2),  CI_lower=round(CI_lower,2),  CI_upper=round(CI_upper,2), p_value=pvalue_adjust(p_value)) 

result$group1[c(2:5, 7:10, 12:15, 17:20, 22:25)]="---"
result%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#%>%
#  kbl() %>%
#  kable_styling()%>%
#scroll_box(height = "300px")
```

## correlation matrix 

```{r, echo=F, message=F, warning=F}
library(reshape2)
sub_data=data.frame(Ging_width_T1=data$Ging_width_T1, Ging_width_T6=data$Ging_width_T6, Ging_thick=data$Ging_thick, Muc_thick=data$Muc_thick,Wound_open_bl_T3=data$Wound_open_bl_T3, Wound_open_bl_T4=data$Wound_open_bl_T4, Wound_open_bl_T5=data$Wound_open_bl_T5, Wound_open_bl_T6=data$Wound_open_bl_T6,Width_3mm_T1=data$Width_3mm_T1
,Width_3mm_T2=data$Width_3mm_T2, Width_3mm_T3=data$width_3mm_T3, Width_3mm_T4=data$Width_3mm_T4,
Width_3mm_T5=data$Width_3mm_T5, Width_3mm_T6=data$Width_3mm_T6, Width_diff_3mm_T2_T1=data$Width_diff_3mm_T2.T1, Width_diff_3mm_T3_T2=data$Width_diff_3mm_T3.T2, Width_diff_3mm_T4_T2=data$Width_diff_3mm_T4.T2, Width_diff_3mm_T5_T2=data$Width_diff_3mm_T5.T2, Width_diff_3mm_T6_T2=data$width_diff_3mm_T6.T2, Buccal_3mm_T2_T1=data$Buccal_3mm_T2.T1, Buccal_3mm_T3_T2=-data$Buccal_3mm_T2.T3, Buccal_3mm_T4_T2=-data$Buccal_3mm_T2.T4, Buccal_3mm_T5_T2=-data$Buccal_3mm_T2.T5, Buccal_3mm_T6_T2=-data$Buccal_3mm_T2.T6, Lingual_3mm_T2_T1=data$Lingual_3mm_T2.T1, Lingual_3mm_T3_T2=-data$Lingual_3mm_T2.T3, Lingual_3mm_T4_T2=-data$Lingual_3mm_T2.T4, Lingual_3mm_T5_T2=-data$Lingual_3mm_T2.T5, Lingual_3mm_T6_T2=-data$Lingual_3mm_T2.T6, Vertical_mid_T2_T1=data$Vertical_max_T2.T1, Vertical_mid_T3_T2=-data$Vertical_max_T2.T3, Vertical_mid_T4_T2=-data$Vertical_max_T2.T4, Vertical_mid_T5_T2=-data$Vertical_max_T2.T5, Vertical_mid_T6_T2=-data$Vertical_max_T2.T6, Vertical_max_T2_T1=data$Vertical_mid_T2.T1, Vertical_max_T3_T2=-data$Vertical_mid_T2.T3, Vertical_max_T4_T2=-data$Vertical_mid_T2.T4, Vertical_max_T5_T2=-data$Vertical_mid_T2.T5, Vertical_max_T6_T2=-data$Vertical_mid_T2.T6, X.Vol_T2.T1.T1=data$X.Vol_T2.T1.T1, X.Vol_T3.T2.T2=data$X.Vol_T3.T2.T2, X.Vol_T4.T2.T2=data$X.Vol_T4.T2.T2,  X.Vol_T5.T2.T2=data$X.Vol_T5.T2.T2,  X.Vol_T6.T2.T2=data$X.Vol_T6.T2.T2, VAS_pain_T1=data$VAS_pain_T1, VAS_pain_T3=data$VAS_pain_T3, VAS_pain_T4=data$VAS_pain_T4, VAS_pain_T5=data$VAS_pain_T5, VAS_pain_T6=data$VAS_pain_T6, VAS_swell_T1=data$VAS_swell_T1,VAS_swell_T3=data$VAS_swell_T3, VAS_swell_T4=data$VAS_swell_T4, VAS_swell_T5=data$VAS_swell_T5, VAS_swell_T6=data$VAS_swell_T6, VAS_mouth_open_T1=data$VAS_mouth_open_T1, VAS_mouth_open_T3=data$VAS_mouth_open_T3, VAS_mouth_open_T4=data$VAS_mouth_open_T4, VAS_mouth_open_T5=data$VAS_mouth_open_T5, VAS_mouth_open_T6=data$VAS_mouth_open_T6, OHIP_T1=data$OHIP_T1, OHIP_T3=data$OHIP_T3, OHIP_T4=data$OHIP_T4, OHIP_T5=data$OHIP.T5, OHIP_T6=data$OHIP_T6)
################ compute p values 
cormat2=round(cor(sub_data),2)
cormat2_pvalue=matrix(nrow=nrow(cormat2), ncol=nrow(cormat2))
for (i in 1:nrow(cormat2))
  for (j in 1:ncol(cormat2))
    cormat2_pvalue[i,j]=round(cor.test(sub_data[,i], sub_data[,j])$p.value,4)
row.names(cormat2_pvalue)=rownames(cormat2) 
colnames(cormat2_pvalue)=rownames(cormat2) 
################
cormat_with_lables <- round(cor(sub_data),2)
sub_data_col_names=colnames(sub_data)
colnames(sub_data)=seq(1:length(sub_data_col_names))
  cormat <- round(cor(sub_data),2)
  
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
  upper_tri <- get_upper_tri(cormat)
  
melted_cormat <- melt(cormat)
melted_cormat_with_labels=melt(cormat_with_lables)

# Melt the correlation matrix
library(reshape2)
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
var_index=seq(1,length(sub_data_col_names), by=3)
var_index2=1:length(sub_data_col_names)
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
  theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1))+
  scale_x_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
  scale_y_continuous("var_index", labels = as.character(var_index), breaks = var_index)+
 coord_fixed()

correlation_pvalue=matrix(paste(cormat2, cormat2_pvalue, sep="_"), nrow=nrow(cormat2))
rownames(correlation_pvalue)=row.names(cormat2)
colnames(correlation_pvalue)=row.names(cormat2)
############################
#ggplot(data = melted_cormat_with_labels, aes(Var2, Var1, fill = value))+
# geom_tile(color = "white")+
# scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
#   midpoint = 0, limit = c(-1,1), space = "Lab", 
#   name="Pearson\nCorrelation") +
#  theme_minimal()+ 
# theme(axis.text.x = element_text(angle = 90, vjust = 0.5, 
#    size = 10, hjust = 0.5))+
# coord_fixed()


#write.csv(cormat2, file="../../2022/202209/Juan/Juan_correlation_matrix_1208_2022.csv")
#write.csv(cormat2_pvalue, file="../../2022/202209/Juan/Juan_correlation_matrix_pvalue_1209_2022.csv")
#write.csv(correlation_pvalue, file="../../2022/202209/Juan/Juan_correlation_matrix_pvalue_1212_2022.csv")
#cormat2%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))

#data.frame(var_index=var_index2, variables=sub_data_col_names)%>%
#datatable(extensions = 'Buttons',
#            options = list(dom = 'Blfrtip',
#                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
#                           lengthMenu = list(c(10,25,50,-1),
#                                             c(10,25,50,"All"))))
```

```{r, echo=F, message=F, warning=F, eval=F}
library(heatmaply)

heatmaply_cor(
  cor(sub_data),
  xlab = "Features", 
  ylab = "Features",
  na.rm=T
)


df <- mtcars
heatmaply_cor(
  cor(df),
  xlab = "Features", 
  ylab = "Features"
)
```



* [correlation matrix and p values](https://marq-my.sharepoint.com/:x:/g/personal/shengtong_han_marquette_edu/EWOTENWbDLBMmNTbeuRAL1wBAwrGqKFJv0EZMDS0Ts6uJw?e=uH1Iwy), i.e. `correlation_pvalue`. 

* `NA` in the correlation matrix means one of variables is constant, no variations leading to meaningless correlation. 

* `var_index` corresponds to row/column index in the correlation matrix 

