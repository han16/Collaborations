---
title: "corr vs restore"
output:
  workflowr::wflow_html:
    code_folding: hide
    toc: true
date: "2024-05-20"
---

```{r, echo=F, message=F, warning=F}
source("C:/Shengtong/Research/AllCollaboration/Collaborations/analysis/Rfunctions.R")
multiplesheets <- function(fname) {
   
  # getting info about all excel sheets
  sheets <- readxl::excel_sheets(fname)
  tibble <- lapply(sheets, function(x) readxl::read_excel(fname, sheet = x))
  data_frame <- lapply(tibble, as.data.frame)
    
  # assigning names to data frames
  names(data_frame) <- sheets
    
  # print data frame
  print(data_frame)
}

```



## Home 

[home](2023_0901_Teerarat.html)





```{r, echo=F, message=F, warning=F, results=F}

data2=multiplesheets("C:\\Shengtong\\Research\\AllCollaboration\\2023\\202309\\Teerarat\\Peri-Implant DATA CLEAN 111023_without_header.xlsx")

```


### Gender


```{r, echo=F, message=F, warning=F}
num_indi1=55
num_indi2=23
data_subset1=data2$`Data RESTORE` %>% dplyr::count(Gender) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()
data_subset1$Gender[data_subset1$Gender==1]="Male"; data_subset1$Gender[data_subset1$Gender==2]="Female"
data_subset2=data2$`Data CORR` %>% dplyr::count(Gender) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()
data_subset2$Gender[data_subset2$Gender==1]="Male"; data_subset2$Gender[data_subset2$Gender==2]="Female"
data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=rep(c("RESTORE", "CORR"), each=nrow(data_subset1)))

data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

#num_male=data_subset %>% filter(Gender=="Male") %>% select(n)%>% pull()
#prop.test(x=num_male,n=c(num_indi1, num_indi2))

common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Gender) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Gender) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Gender==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))

```
 * two sample proportion test was used 
 
 * p value of 0.027 suggests different male proportions between two samples 
 
 
### Smoking 
 
 
```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Smoking) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Smoking) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$Smoking[data_subset$Smoking==1]="Never"; data_subset$Smoking[data_subset$Smoking==2]="Past"
data_subset$Smoking[data_subset$Smoking==3]="Current"; data_subset$Smoking[data_subset$Smoking==4]="not reported"


data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Smoking) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Smoking) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Smoking==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Diabetes


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Diabetes) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Diabetes) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$Diabetes[data_subset$Diabetes==1]="Yes"; data_subset$Diabetes[data_subset$Diabetes==2]="No"


data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Diabetes) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Diabetes) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Diabetes==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Implant_site




```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Implant_site) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()
index1=which(data_subset1$Implant_site<=16); index2=which(data_subset1$Implant_site>16)
n=c(sum(data_subset1$n[index1]), sum(data_subset1$n[index2]))
prop=c(sum(data_subset1$prop[index1]), sum(data_subset1$prop[index2]))
data_subset11=data.frame(Implant_site=c("Maxilla", "Mandible"), n=n, prop=prop)

data_subset2=data2$`Data CORR` %>% dplyr::count(Implant_site) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()
index1=which(data_subset2$Implant_site<=16); index2=which(data_subset2$Implant_site>16)
n=c(sum(data_subset2$n[index1]), sum(data_subset2$n[index2]))
prop=c(sum(data_subset2$prop[index1]), sum(data_subset2$prop[index2]))
data_subset22=data.frame(Implant_site=c("Maxilla", "Mandible"), n=n, prop=prop)

data_subset=rbind(data_subset11, data_subset22) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset11)), rep("CORR", nrow(data_subset22))))



data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Implant_site) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Implant_site) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Implant_site==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Implant_site




```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Implant_site) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()
index1=union(which(data_subset1$Implant_site<=5), which(data_subset1$Implant_site<=16 & data_subset1$Implant_site>=12)); index2=which(data_subset1$Implant_site>=6 &data_subset1$Implant_site<=11);
index3=union(which(data_subset1$Implant_site>=17 & data_subset1$Implant_site<=21), which(data_subset1$Implant_site<=31 & data_subset1$Implant_site>=28));
index4=which(data_subset1$Implant_site>=22 &data_subset1$Implant_site<=27 )

n=c(sum(data_subset1$n[index1]), sum(data_subset1$n[index2]), sum(data_subset1$n[index3]), sum(data_subset1$n[index4]))
prop=c(sum(data_subset1$prop[index1]), sum(data_subset1$prop[index2]), sum(data_subset1$prop[index3]), sum(data_subset1$prop[index4]))
data_subset11=data.frame(Implant_site=c("Upper posterior", "Upper anterior", "Lower posterior", "Lower anterior"), n=n, prop=prop)

data_subset2=data2$`Data CORR` %>% dplyr::count(Implant_site) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()
index1=union(which(data_subset2$Implant_site<=5), which(data_subset2$Implant_site<=16 & data_subset2$Implant_site>=12)); index2=which(data_subset2$Implant_site>=6 &data_subset2$Implant_site<=11);
index3=union(which(data_subset2$Implant_site>=17 & data_subset2$Implant_site<=21), which(data_subset2$Implant_site<=31 & data_subset2$Implant_site>=28));
index4=which(data_subset2$Implant_site>=22 &data_subset2$Implant_site<=27 )

n=c(sum(data_subset2$n[index1]), sum(data_subset2$n[index2]), sum(data_subset2$n[index3]), sum(data_subset2$n[index4]))
prop=c(sum(data_subset2$prop[index1]), sum(data_subset2$prop[index2]), sum(data_subset2$prop[index3]), sum(data_subset2$prop[index4]))
data_subset22=data.frame(Implant_site=c("Upper posterior", "Upper anterior", "Lower posterior", "Lower anterior"), n=n, prop=prop)

data_subset=rbind(data_subset11, data_subset22) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset11)), rep("CORR", nrow(data_subset22))))



data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Implant_site) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Implant_site) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Implant_site==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Pre_implant_Procedure



```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Pre_implant_Procedure) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Pre_implant_Procedure) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==1]="Extraction alone"; data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==2]="Extraction and bone graft"; 
data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==3]="Extraction, bone graft and membrane";
data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==4]="GBR";
data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==6]="other";
data_subset$Pre_implant_Procedure[data_subset$Pre_implant_Procedure==7]="not reported";



data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Pre_implant_Procedure) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Pre_implant_Procedure) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Pre_implant_Procedure==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### I_placement



```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_placement) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_placement) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$I_placement[data_subset$I_placement==1]="Single implant placement"; data_subset$I_placement[data_subset$I_placement==2]="Placement with bone graft"; 
data_subset$I_placement[data_subset$I_placement==4]="Placement with bone graft and membrane";
data_subset$I_placement[data_subset$I_placement==5]="Placement with indirect sinus lift";
data_subset$I_placement[data_subset$I_placement==7]="Immediate/delayed placement";
data_subset$I_placement[data_subset$I_placement==8]="other";




data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_placement) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_placement) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_placement==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Comp_placement



```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Comp_placement) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Comp_placement) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$Comp_placement[data_subset$Comp_placement==1]="Adjusted direction during drill sequence"; data_subset$Comp_placement[data_subset$Comp_placement==2]="Guide broke, did not fit"; 
data_subset$Comp_placement[data_subset$Comp_placement==3]="Implant placed, immediately removed, reinserted";
data_subset$Comp_placement[data_subset$Comp_placement==4]="Bone perforatio during drilling or implant placement";
data_subset$Comp_placement[data_subset$Comp_placement==5]="Bone dehiscence during drilling or implant placement";
data_subset$Comp_placement[data_subset$Comp_placement==6]="Damage to vital structures";
data_subset$Comp_placement[data_subset$Comp_placement==7]="Flap tear/perforation/other damage";
data_subset$Comp_placement[data_subset$Comp_placement==8]="other";
data_subset$Comp_placement[data_subset$Comp_placement==9]="none/WNL";



data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Comp_placement) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Comp_placement) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Comp_placement==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### HA



```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(HA) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(HA) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$HA[data_subset$HA==1]="Yes"; 
data_subset$HA[data_subset$HA==2]="No"; 




data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(HA) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(HA) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(HA==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### I_Brand


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_Brand) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_Brand) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$I_Brand[data_subset$I_Brand==1]="Nobel Biocare";
data_subset$I_Brand[data_subset$I_Brand==2]="Nobel Replace";
data_subset$I_Brand[data_subset$I_Brand==3]="Straumann BLT"; 
data_subset$I_Brand[data_subset$I_Brand==4]="Osseospeed Ev"; 
data_subset$I_Brand[data_subset$I_Brand==5]="Nobel Replace Connical Connection";
data_subset$I_Brand[data_subset$I_Brand==6]="Atra EV";
data_subset$I_Brand[data_subset$I_Brand==7]="BioHorizons Tapered Plus";
data_subset$I_Brand[data_subset$I_Brand==8]="Nobel Replace Select";
data_subset$I_Brand[data_subset$I_Brand==9]="Nobel Replace Tapered Groovy";
data_subset$I_Brand[data_subset$I_Brand==10]="Nobel Active Internal RP";
data_subset$I_Brand[data_subset$I_Brand==11]="Straumann WN";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_Brand) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_Brand) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_Brand==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### I_Surface



```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_Surface) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_Surface) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$I_Surface[data_subset$I_Surface==1]="TiUltra";
data_subset$I_Surface[data_subset$I_Surface==2]="TiUnite"; 
data_subset$I_Surface[data_subset$I_Surface==3]="SLA";
data_subset$I_Surface[data_subset$I_Surface==4]="TiO2";
data_subset$I_Surface[data_subset$I_Surface==5]="Ti";
data_subset$I_Surface[data_subset$I_Surface==6]="TLXP3812";
data_subset$I_Surface[data_subset$I_Surface==7]="Tiu"; 






data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_Surface) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_Surface) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_Surface==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### I_Shape


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_Shape) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_Shape) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))
data_subset$I_Shape[data_subset$I_Shape==1]="straight"; 
data_subset$I_Shape[data_subset$I_Shape==2]="tapered"; 







data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_Shape) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_Shape) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_Shape==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### I_Techique


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_Technique) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_Technique) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))

data_subset$I_Technique[data_subset$I_Technique==1]="Free handed"; 
data_subset$I_Technique[data_subset$I_Technique==2]="Pilot guided";
data_subset$I_Technique[data_subset$I_Technique==3]="Fully guided";
data_subset$I_Technique[data_subset$I_Technique==4]="Surgical guide";
data_subset$I_Technique[data_subset$I_Technique==5]="not reported"; 







data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_Technique) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_Technique) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_Technique==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### I_Location


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(I_Location) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(I_Location) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))

data_subset$I_Location[data_subset$I_Location==1]="Supracrestal";
data_subset$I_Location[data_subset$I_Location==2]="Equicrestal"; 
data_subset$I_Location[data_subset$I_Location==3]="Subcrestal";







data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(I_Location) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(I_Location) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(I_Location==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Postop_med


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Postop_med) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Postop_med) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Postop_med[data_subset$Postop_med==1]="Amoxicillin";
data_subset$Postop_med[data_subset$Postop_med==2]="Clindamycin"; 
data_subset$Postop_med[data_subset$Postop_med==3]="Azithromycin";
data_subset$Postop_med[data_subset$Postop_med==4]="not reported"; 
data_subset$Postop_med[data_subset$Postop_med==5]="doxycycline"
data_subset$Postop_med[data_subset$Postop_med==6]="antibiotic not specified"







data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Postop_med) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Postop_med) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Postop_med==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Premed


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Premed) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Premed) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Premed[data_subset$Premed==1]="Amoxicillin";
data_subset$Premed[data_subset$Premed==2]="not reported"; 







data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Premed) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Premed) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Premed==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Provider_level


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Provider_level) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Provider_level) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Provider_level[data_subset$Provider_level==1]="Faculty";
data_subset$Provider_level[data_subset$Provider_level==2]="Perio resident";
data_subset$Provider_level[data_subset$Provider_level==3]="Pros resident";
data_subset$Provider_level[data_subset$Provider_level==4]="AEGD resident";






data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Provider_level) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Provider_level) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Provider_level==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Present_comp_post_placement


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Present_comp_post_placement) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Present_comp_post_placement) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Present_comp_post_placement[data_subset$Present_comp_post_placement==1]="yes";
data_subset$Present_comp_post_placement[data_subset$Present_comp_post_placement==2]="no";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Present_comp_post_placement) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Present_comp_post_placement) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Present_comp_post_placement==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Coverscrew_exp_post_placement


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Coverscrew_exp_post_placement) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Coverscrew_exp_post_placement) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Coverscrew_exp_post_placement[data_subset$Coverscrew_exp_post_placement==1]="yes";
data_subset$Coverscrew_exp_post_placement[data_subset$Coverscrew_exp_post_placement==2]="no";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Coverscrew_exp_post_placement) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Coverscrew_exp_post_placement) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Coverscrew_exp_post_placement==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```


### Infection/pus_post_placement


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(`Infection/pus_post_placement`) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(`Infection/pus_post_placement`) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$`Infection/pus_post_placement`[data_subset$`Infection/pus_post_placement`==1]="yes";
data_subset$`Infection/pus_post_placement`[data_subset$`Infection/pus_post_placement`==2]="no";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(`Infection/pus_post_placement`) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(`Infection/pus_post_placement`) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(`Infection/pus_post_placement`==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Other_post_placement


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Other_post_placement) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Other_post_placement) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Other_post_placement[data_subset$Other_post_placement==1]="yes";
data_subset$Other_post_placement[data_subset$Other_post_placement==2]="no";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Other_post_placement) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Other_post_placement) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Other_post_placement==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```



### Type_bone_loss


```{r, echo=F, message=F, warning=F}

data_subset1=data2$`Data RESTORE` %>% dplyr::count(Type_bone_loss) %>% mutate(prop=round(n/num_indi1,4)) %>% drop_na()

data_subset2=data2$`Data CORR` %>% dplyr::count(Type_bone_loss) %>% mutate(prop=round(n/num_indi2,4)) %>% drop_na()

data_subset=rbind(data_subset1, data_subset2) %>% mutate(sample=c(rep("RESTORE", nrow(data_subset1)), rep("CORR", nrow(data_subset2))))


data_subset$Type_bone_loss[data_subset$Type_bone_loss==1]="vertical";
data_subset$Type_bone_loss[data_subset$Type_bone_loss==2]="horizontal";





data_subset%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All"))))


common_variable=intersect(data_subset %>% filter(sample=="RESTORE") %>% select(Type_bone_loss) %>% pull(), data_subset %>% filter(sample=="CORR") %>% select(Type_bone_loss) %>% pull())
pvalue=numeric()
for (i in 1:length(common_variable))
{
  variable_count=data_subset %>% filter(Type_bone_loss==common_variable[i]) %>% select(n) %>% pull()
  pvalue[i]=pvalue_adjust(prop.test(x=variable_count, n=c(num_indi1, num_indi2))$p.value)
}
data.frame(variable=paste(common_variable, ":RESTORE_vs_CORR"), pvalue=pvalue)%>%
datatable(extensions = 'Buttons',
            options = list(dom = 'Blfrtip',
                           buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
                           lengthMenu = list(c(10,25,50,-1),
                                             c(10,25,50,"All")))) 
```